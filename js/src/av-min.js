// build time:Sat Jun 22 2019 13:31:48 GMT+0800 (GMT+08:00)
(function e(t,n){if(typeof exports==="object"&&typeof module==="object")module.exports=n();else if(typeof define==="function"&&define.amd)define([],n);else if(typeof exports==="object")exports["AV"]=n();else t["AV"]=n()})(typeof self!=="undefined"?self:this,function(){return function(e){var t={};function n(r){if(t[r]){return t[r].exports}var i=t[r]={i:r,l:false,exports:{}};e[r].call(i.exports,i,i.exports,n);i.l=true;return i.exports}n.m=e;n.c=t;n.d=function(e,t,r){if(!n.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:r})}};n.n=function(e){var t=e&&e.__esModule?function r(){return e["default"]}:function i(){return e};n.d(t,"a",t);return t};n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};n.p="";return n(n.s=15)}([function(e,t,n){(function(e,n){var r,i;(function(){var s=typeof self=="object"&&self.self===self&&self||typeof e=="object"&&e.global===e&&e||this||{};var o=s._;var a=Array.prototype,u=Object.prototype;var c=typeof Symbol!=="undefined"?Symbol.prototype:null;var f=a.push,l=a.slice,h=u.toString,d=u.hasOwnProperty;var p=Array.isArray,v=Object.keys,_=Object.create;var y=function(){};var m=function(e){if(e instanceof m)return e;if(!(this instanceof m))return new m(e);this._wrapped=e};if(typeof t!="undefined"&&!t.nodeType){if(typeof n!="undefined"&&!n.nodeType&&n.exports){t=n.exports=m}t._=m}else{s._=m}m.VERSION="1.9.1";var g=function(e,t,n){if(t===void 0)return e;switch(n==null?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)}}return function(){return e.apply(t,arguments)}};var b;var w=function(e,t,n){if(m.iteratee!==b)return m.iteratee(e,t);if(e==null)return m.identity;if(m.isFunction(e))return g(e,t,n);if(m.isObject(e)&&!m.isArray(e))return m.matcher(e);return m.property(e)};m.iteratee=b=function(e,t){return w(e,t,Infinity)};var O=function(e,t){t=t==null?e.length-1:+t;return function(){var n=Math.max(arguments.length-t,0),r=Array(n),i=0;for(;i<n;i++){r[i]=arguments[i+t]}switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var s=Array(t+1);for(i=0;i<t;i++){s[i]=arguments[i]}s[t]=r;return e.apply(this,s)}};var A=function(e){if(!m.isObject(e))return{};if(_)return _(e);y.prototype=e;var t=new y;y.prototype=null;return t};var S=function(e){return function(t){return t==null?void 0:t[e]}};var C=function(e,t){return e!=null&&d.call(e,t)};var E=function(e,t){var n=t.length;for(var r=0;r<n;r++){if(e==null)return void 0;e=e[t[r]]}return n?e:void 0};var T=Math.pow(2,53)-1;var N=S("length");var j=function(e){var t=N(e);return typeof t=="number"&&t>=0&&t<=T};m.each=m.forEach=function(e,t,n){t=g(t,n);var r,i;if(j(e)){for(r=0,i=e.length;r<i;r++){t(e[r],r,e)}}else{var s=m.keys(e);for(r=0,i=s.length;r<i;r++){t(e[s[r]],s[r],e)}}return e};m.map=m.collect=function(e,t,n){t=w(t,n);var r=!j(e)&&m.keys(e),i=(r||e).length,s=Array(i);for(var o=0;o<i;o++){var a=r?r[o]:o;s[o]=t(e[a],a,e)}return s};var x=function(e){var t=function(t,n,r,i){var s=!j(t)&&m.keys(t),o=(s||t).length,a=e>0?0:o-1;if(!i){r=t[s?s[a]:a];a+=e}for(;a>=0&&a<o;a+=e){var u=s?s[a]:a;r=n(r,t[u],u,t)}return r};return function(e,n,r,i){var s=arguments.length>=3;return t(e,g(n,i,4),r,s)}};m.reduce=m.foldl=m.inject=x(1);m.reduceRight=m.foldr=x(-1);m.find=m.detect=function(e,t,n){var r=j(e)?m.findIndex:m.findKey;var i=r(e,t,n);if(i!==void 0&&i!==-1)return e[i]};m.filter=m.select=function(e,t,n){var r=[];t=w(t,n);m.each(e,function(e,n,i){if(t(e,n,i))r.push(e)});return r};m.reject=function(e,t,n){return m.filter(e,m.negate(w(t)),n)};m.every=m.all=function(e,t,n){t=w(t,n);var r=!j(e)&&m.keys(e),i=(r||e).length;for(var s=0;s<i;s++){var o=r?r[s]:s;if(!t(e[o],o,e))return false}return true};m.some=m.any=function(e,t,n){t=w(t,n);var r=!j(e)&&m.keys(e),i=(r||e).length;for(var s=0;s<i;s++){var o=r?r[s]:s;if(t(e[o],o,e))return true}return false};m.contains=m.includes=m.include=function(e,t,n,r){if(!j(e))e=m.values(e);if(typeof n!="number"||r)n=0;return m.indexOf(e,t,n)>=0};m.invoke=O(function(e,t,n){var r,i;if(m.isFunction(t)){i=t}else if(m.isArray(t)){r=t.slice(0,-1);t=t[t.length-1]}return m.map(e,function(e){var s=i;if(!s){if(r&&r.length){e=E(e,r)}if(e==null)return void 0;s=e[t]}return s==null?s:s.apply(e,n)})});m.pluck=function(e,t){return m.map(e,m.property(t))};m.where=function(e,t){return m.filter(e,m.matcher(t))};m.findWhere=function(e,t){return m.find(e,m.matcher(t))};m.max=function(e,t,n){var r=-Infinity,i=-Infinity,s,o;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=j(e)?e:m.values(e);for(var a=0,u=e.length;a<u;a++){s=e[a];if(s!=null&&s>r){r=s}}}else{t=w(t,n);m.each(e,function(e,n,s){o=t(e,n,s);if(o>i||o===-Infinity&&r===-Infinity){r=e;i=o}})}return r};m.min=function(e,t,n){var r=Infinity,i=Infinity,s,o;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=j(e)?e:m.values(e);for(var a=0,u=e.length;a<u;a++){s=e[a];if(s!=null&&s<r){r=s}}}else{t=w(t,n);m.each(e,function(e,n,s){o=t(e,n,s);if(o<i||o===Infinity&&r===Infinity){r=e;i=o}})}return r};m.shuffle=function(e){return m.sample(e,Infinity)};m.sample=function(e,t,n){if(t==null||n){if(!j(e))e=m.values(e);return e[m.random(e.length-1)]}var r=j(e)?m.clone(e):m.values(e);var i=N(r);t=Math.max(Math.min(t,i),0);var s=i-1;for(var o=0;o<t;o++){var a=m.random(o,s);var u=r[o];r[o]=r[a];r[a]=u}return r.slice(0,t)};m.sortBy=function(e,t,n){var r=0;t=w(t,n);return m.pluck(m.map(e,function(e,n,i){return{value:e,index:r++,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria;var r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var U=function(e,t){return function(n,r,i){var s=t?[[],[]]:{};r=w(r,i);m.each(n,function(t,i){var o=r(t,i,n);e(s,t,o)});return s}};m.groupBy=U(function(e,t,n){if(C(e,n))e[n].push(t);else e[n]=[t]});m.indexBy=U(function(e,t,n){e[n]=t});m.countBy=U(function(e,t,n){if(C(e,n))e[n]++;else e[n]=1});var k=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;m.toArray=function(e){if(!e)return[];if(m.isArray(e))return l.call(e);if(m.isString(e)){return e.match(k)}if(j(e))return m.map(e,m.identity);return m.values(e)};m.size=function(e){if(e==null)return 0;return j(e)?e.length:m.keys(e).length};m.partition=U(function(e,t,n){e[n?0:1].push(t)},true);m.first=m.head=m.take=function(e,t,n){if(e==null||e.length<1)return t==null?void 0:[];if(t==null||n)return e[0];return m.initial(e,e.length-t)};m.initial=function(e,t,n){return l.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))};m.last=function(e,t,n){if(e==null||e.length<1)return t==null?void 0:[];if(t==null||n)return e[e.length-1];return m.rest(e,Math.max(0,e.length-t))};m.rest=m.tail=m.drop=function(e,t,n){return l.call(e,t==null||n?1:t)};m.compact=function(e){return m.filter(e,Boolean)};var I=function(e,t,n,r){r=r||[];var i=r.length;for(var s=0,o=N(e);s<o;s++){var a=e[s];if(j(a)&&(m.isArray(a)||m.isArguments(a))){if(t){var u=0,c=a.length;while(u<c)r[i++]=a[u++]}else{I(a,t,n,r);i=r.length}}else if(!n){r[i++]=a}}return r};m.flatten=function(e,t){return I(e,t,false)};m.without=O(function(e,t){return m.difference(e,t)});m.uniq=m.unique=function(e,t,n,r){if(!m.isBoolean(t)){r=n;n=t;t=false}if(n!=null)n=w(n,r);var i=[];var s=[];for(var o=0,a=N(e);o<a;o++){var u=e[o],c=n?n(u,o,e):u;if(t&&!n){if(!o||s!==c)i.push(u);s=c}else if(n){if(!m.contains(s,c)){s.push(c);i.push(u)}}else if(!m.contains(i,u)){i.push(u)}}return i};m.union=O(function(e){return m.uniq(I(e,true,true))});m.intersection=function(e){var t=[];var n=arguments.length;for(var r=0,i=N(e);r<i;r++){var s=e[r];if(m.contains(t,s))continue;var o;for(o=1;o<n;o++){if(!m.contains(arguments[o],s))break}if(o===n)t.push(s)}return t};m.difference=O(function(e,t){t=I(t,true,true);return m.filter(e,function(e){return!m.contains(t,e)})});m.unzip=function(e){var t=e&&m.max(e,N).length||0;var n=Array(t);for(var r=0;r<t;r++){n[r]=m.pluck(e,r)}return n};m.zip=O(m.unzip);m.object=function(e,t){var n={};for(var r=0,i=N(e);r<i;r++){if(t){n[e[r]]=t[r]}else{n[e[r][0]]=e[r][1]}}return n};var R=function(e){return function(t,n,r){n=w(n,r);var i=N(t);var s=e>0?0:i-1;for(;s>=0&&s<i;s+=e){if(n(t[s],s,t))return s}return-1}};m.findIndex=R(1);m.findLastIndex=R(-1);m.sortedIndex=function(e,t,n,r){n=w(n,r,1);var i=n(t);var s=0,o=N(e);while(s<o){var a=Math.floor((s+o)/2);if(n(e[a])<i)s=a+1;else o=a}return s};var D=function(e,t,n){return function(r,i,s){var o=0,a=N(r);if(typeof s=="number"){if(e>0){o=s>=0?s:Math.max(s+a,o)}else{a=s>=0?Math.min(s+1,a):s+a+1}}else if(n&&s&&a){s=n(r,i);return r[s]===i?s:-1}if(i!==i){s=t(l.call(r,o,a),m.isNaN);return s>=0?s+o:-1}for(s=e>0?o:a-1;s>=0&&s<a;s+=e){if(r[s]===i)return s}return-1}};m.indexOf=D(1,m.findIndex,m.sortedIndex);m.lastIndexOf=D(-1,m.findLastIndex);m.range=function(e,t,n){if(t==null){t=e||0;e=0}if(!n){n=t<e?-1:1}var r=Math.max(Math.ceil((t-e)/n),0);var i=Array(r);for(var s=0;s<r;s++,e+=n){i[s]=e}return i};m.chunk=function(e,t){if(t==null||t<1)return[];var n=[];var r=0,i=e.length;while(r<i){n.push(l.call(e,r,r+=t))}return n};var P=function(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var s=A(e.prototype);var o=e.apply(s,i);if(m.isObject(o))return o;return s};m.bind=O(function(e,t,n){if(!m.isFunction(e))throw new TypeError("Bind must be called on a function");var r=O(function(i){return P(e,r,t,this,n.concat(i))});return r});m.partial=O(function(e,t){var n=m.partial.placeholder;var r=function(){var i=0,s=t.length;var o=Array(s);for(var a=0;a<s;a++){o[a]=t[a]===n?arguments[i++]:t[a]}while(i<arguments.length)o.push(arguments[i++]);return P(e,r,this,this,o)};return r});m.partial.placeholder=m;m.bindAll=O(function(e,t){t=I(t,false,false);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");while(n--){var r=t[n];e[r]=m.bind(e[r],e)}});m.memoize=function(e,t){var n=function(r){var i=n.cache;var s=""+(t?t.apply(this,arguments):r);if(!C(i,s))i[s]=e.apply(this,arguments);return i[s]};n.cache={};return n};m.delay=O(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)});m.defer=m.partial(m.delay,m,1);m.throttle=function(e,t,n){var r,i,s,o;var a=0;if(!n)n={};var u=function(){a=n.leading===false?0:m.now();r=null;o=e.apply(i,s);if(!r)i=s=null};var c=function(){var c=m.now();if(!a&&n.leading===false)a=c;var f=t-(c-a);i=this;s=arguments;if(f<=0||f>t){if(r){clearTimeout(r);r=null}a=c;o=e.apply(i,s);if(!r)i=s=null}else if(!r&&n.trailing!==false){r=setTimeout(u,f)}return o};c.cancel=function(){clearTimeout(r);a=0;r=i=s=null};return c};m.debounce=function(e,t,n){var r,i;var s=function(t,n){r=null;if(n)i=e.apply(t,n)};var o=O(function(o){if(r)clearTimeout(r);if(n){var a=!r;r=setTimeout(s,t);if(a)i=e.apply(this,o)}else{r=m.delay(s,t,this,o)}return i});o.cancel=function(){clearTimeout(r);r=null};return o};m.wrap=function(e,t){return m.partial(t,e)};m.negate=function(e){return function(){return!e.apply(this,arguments)}};m.compose=function(){var e=arguments;var t=e.length-1;return function(){var n=t;var r=e[t].apply(this,arguments);while(n--)r=e[n].call(this,r);return r}};m.after=function(e,t){return function(){if(--e<1){return t.apply(this,arguments)}}};m.before=function(e,t){var n;return function(){if(--e>0){n=t.apply(this,arguments)}if(e<=1)t=null;return n}};m.once=m.partial(m.before,2);m.restArguments=O;var L=!{toString:null}.propertyIsEnumerable("toString");var F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];var q=function(e,t){var n=F.length;var r=e.constructor;var i=m.isFunction(r)&&r.prototype||u;var s="constructor";if(C(e,s)&&!m.contains(t,s))t.push(s);while(n--){s=F[n];if(s in e&&e[s]!==i[s]&&!m.contains(t,s)){t.push(s)}}};m.keys=function(e){if(!m.isObject(e))return[];if(v)return v(e);var t=[];for(var n in e)if(C(e,n))t.push(n);if(L)q(e,t);return t};m.allKeys=function(e){if(!m.isObject(e))return[];var t=[];for(var n in e)t.push(n);if(L)q(e,t);return t};m.values=function(e){var t=m.keys(e);var n=t.length;var r=Array(n);for(var i=0;i<n;i++){r[i]=e[t[i]]}return r};m.mapObject=function(e,t,n){t=w(t,n);var r=m.keys(e),i=r.length,s={};for(var o=0;o<i;o++){var a=r[o];s[a]=t(e[a],a,e)}return s};m.pairs=function(e){var t=m.keys(e);var n=t.length;var r=Array(n);for(var i=0;i<n;i++){r[i]=[t[i],e[t[i]]]}return r};m.invert=function(e){var t={};var n=m.keys(e);for(var r=0,i=n.length;r<i;r++){t[e[n[r]]]=n[r]}return t};m.functions=m.methods=function(e){var t=[];for(var n in e){if(m.isFunction(e[n]))t.push(n)}return t.sort()};var M=function(e,t){return function(n){var r=arguments.length;if(t)n=Object(n);if(r<2||n==null)return n;for(var i=1;i<r;i++){var s=arguments[i],o=e(s),a=o.length;for(var u=0;u<a;u++){var c=o[u];if(!t||n[c]===void 0)n[c]=s[c]}}return n}};m.extend=M(m.allKeys);m.extendOwn=m.assign=M(m.keys);m.findKey=function(e,t,n){t=w(t,n);var r=m.keys(e),i;for(var s=0,o=r.length;s<o;s++){i=r[s];if(t(e[i],i,e))return i}};var W=function(e,t,n){return t in n};m.pick=O(function(e,t){var n={},r=t[0];if(e==null)return n;if(m.isFunction(r)){if(t.length>1)r=g(r,t[1]);t=m.allKeys(e)}else{r=W;t=I(t,false,false);e=Object(e)}for(var i=0,s=t.length;i<s;i++){var o=t[i];var a=e[o];if(r(a,o,e))n[o]=a}return n});m.omit=O(function(e,t){var n=t[0],r;if(m.isFunction(n)){n=m.negate(n);if(t.length>1)r=t[1]}else{t=m.map(I(t,false,false),String);n=function(e,n){return!m.contains(t,n)}}return m.pick(e,n,r)});m.defaults=M(m.allKeys,true);m.create=function(e,t){var n=A(e);if(t)m.extendOwn(n,t);return n};m.clone=function(e){if(!m.isObject(e))return e;return m.isArray(e)?e.slice():m.extend({},e)};m.tap=function(e,t){t(e);return e};m.isMatch=function(e,t){var n=m.keys(t),r=n.length;if(e==null)return!r;var i=Object(e);for(var s=0;s<r;s++){var o=n[s];if(t[o]!==i[o]||!(o in i))return false}return true};var B,J;B=function(e,t,n,r){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return false;if(e!==e)return t!==t;var i=typeof e;if(i!=="function"&&i!=="object"&&typeof t!="object")return false;return J(e,t,n,r)};J=function(e,t,n,r){if(e instanceof m)e=e._wrapped;if(t instanceof m)t=t._wrapped;var i=h.call(e);if(i!==h.call(t))return false;switch(i){case"[object RegExp]":case"[object String]":return""+e===""+t;case"[object Number]":if(+e!==+e)return+t!==+t;return+e===0?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return c.valueOf.call(e)===c.valueOf.call(t)}var s=i==="[object Array]";if(!s){if(typeof e!="object"||typeof t!="object")return false;var o=e.constructor,a=t.constructor;if(o!==a&&!(m.isFunction(o)&&o instanceof o&&m.isFunction(a)&&a instanceof a)&&("constructor"in e&&"constructor"in t)){return false}}n=n||[];r=r||[];var u=n.length;while(u--){if(n[u]===e)return r[u]===t}n.push(e);r.push(t);if(s){u=e.length;if(u!==t.length)return false;while(u--){if(!B(e[u],t[u],n,r))return false}}else{var f=m.keys(e),l;u=f.length;if(m.keys(t).length!==u)return false;while(u--){l=f[u];if(!(C(t,l)&&B(e[l],t[l],n,r)))return false}}n.pop();r.pop();return true};m.isEqual=function(e,t){return B(e,t)};m.isEmpty=function(e){if(e==null)return true;if(j(e)&&(m.isArray(e)||m.isString(e)||m.isArguments(e)))return e.length===0;return m.keys(e).length===0};m.isElement=function(e){return!!(e&&e.nodeType===1)};m.isArray=p||function(e){return h.call(e)==="[object Array]"};m.isObject=function(e){var t=typeof e;return t==="function"||t==="object"&&!!e};m.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){m["is"+e]=function(t){return h.call(t)==="[object "+e+"]"}});if(!m.isArguments(arguments)){m.isArguments=function(e){return C(e,"callee")}}var Q=s.document&&s.document.childNodes;if(typeof/./!="function"&&typeof Int8Array!="object"&&typeof Q!="function"){m.isFunction=function(e){return typeof e=="function"||false}}m.isFinite=function(e){return!m.isSymbol(e)&&isFinite(e)&&!isNaN(parseFloat(e))};m.isNaN=function(e){return m.isNumber(e)&&isNaN(e)};m.isBoolean=function(e){return e===true||e===false||h.call(e)==="[object Boolean]"};m.isNull=function(e){return e===null};m.isUndefined=function(e){return e===void 0};m.has=function(e,t){if(!m.isArray(t)){return C(e,t)}var n=t.length;for(var r=0;r<n;r++){var i=t[r];if(e==null||!d.call(e,i)){return false}e=e[i]}return!!n};m.noConflict=function(){s._=o;return this};m.identity=function(e){return e};m.constant=function(e){return function(){return e}};m.noop=function(){};m.property=function(e){if(!m.isArray(e)){return S(e)}return function(t){return E(t,e)}};m.propertyOf=function(e){if(e==null){return function(){}}return function(t){return!m.isArray(t)?e[t]:E(e,t)}};m.matcher=m.matches=function(e){e=m.extendOwn({},e);return function(t){return m.isMatch(t,e)}};m.times=function(e,t,n){var r=Array(Math.max(0,e));t=g(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r};m.random=function(e,t){if(t==null){t=e;e=0}return e+Math.floor(Math.random()*(t-e+1))};m.now=Date.now||function(){return(new Date).getTime()};var V={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var K=m.invert(V);var z=function(e){var t=function(t){return e[t]};var n="(?:"+m.keys(e).join("|")+")";var r=RegExp(n);var i=RegExp(n,"g");return function(e){e=e==null?"":""+e;return r.test(e)?e.replace(i,t):e}};m.escape=z(V);m.unescape=z(K);m.result=function(e,t,n){if(!m.isArray(t))t=[t];var r=t.length;if(!r){return m.isFunction(n)?n.call(e):n}for(var i=0;i<r;i++){var s=e==null?void 0:e[t[i]];if(s===void 0){s=n;i=r}e=m.isFunction(s)?s.call(e):s}return e};var G=0;m.uniqueId=function(e){var t=++G+"";return e?e+t:t};m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/;var $={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var X=/\\|'|\r|\n|\u2028|\u2029/g;var Y=function(e){return"\\"+$[e]};m.template=function(e,t,n){if(!t&&n)t=n;t=m.defaults({},t,m.templateSettings);var r=RegExp([(t.escape||H).source,(t.interpolate||H).source,(t.evaluate||H).source].join("|")+"|$","g");var i=0;var s="__p+='";e.replace(r,function(t,n,r,o,a){s+=e.slice(i,a).replace(X,Y);i=a+t.length;if(n){s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"}else if(r){s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"}else if(o){s+="';\n"+o+"\n__p+='"}return t});s+="';\n";if(!t.variable)s="with(obj||{}){\n"+s+"}\n";s="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";var o;try{o=new Function(t.variable||"obj","_",s)}catch(a){a.source=s;throw a}var u=function(e){return o.call(this,e,m)};var c=t.variable||"obj";u.source="function("+c+"){\n"+s+"}";return u};m.chain=function(e){var t=m(e);t._chain=true;return t};var Z=function(e,t){return e._chain?m(t).chain():t};m.mixin=function(e){m.each(m.functions(e),function(t){var n=m[t]=e[t];m.prototype[t]=function(){var e=[this._wrapped];f.apply(e,arguments);return Z(this,n.apply(m,e))}});return m};m.mixin(m);m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];m.prototype[e]=function(){var n=this._wrapped;t.apply(n,arguments);if((e==="shift"||e==="splice")&&n.length===0)delete n[0];return Z(this,n)}});m.each(["concat","join","slice"],function(e){var t=a[e];m.prototype[e]=function(){return Z(this,t.apply(this._wrapped,arguments))}});m.prototype.value=function(){return this._wrapped};m.prototype.valueOf=m.prototype.toJSON=m.prototype.value;m.prototype.toString=function(){return String(this._wrapped)};if(true){!(r=[],i=function(){return m}.apply(t,r),i!==undefined&&(n.exports=i))}})()}).call(t,n(7),n(17)(e))},function(e,t,n){"use strict";var r=n(29).Promise;r._continueWhile=function(e,t){if(e()){return t().then(function(){return r._continueWhile(e,t)})}return r.resolve()};e.exports=r},function(e,t,n){"use strict";var r=n(0);var i=n(44);var s=n(0),o=s.extend;var a=n(1);var u=n(5);var c=n(3),f=c.getSessionToken,l=c.ajax;var h=function m(e,t){var n=(new Date).getTime();var r=i(n+e);if(t){return r+","+n+",master"}return r+","+n};var d=function g(e,t){if(t){e["X-LC-Sign"]=h(u.applicationKey)}else{e["X-LC-Key"]=u.applicationKey}};var p=function b(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=arguments[1];var n={"X-LC-Id":u.applicationId,"Content-Type":"application/json;charset=UTF-8"};var r=false;if(typeof e.useMasterKey==="boolean"){r=e.useMasterKey}else if(typeof u._config.useMasterKey==="boolean"){r=u._config.useMasterKey}if(r){if(u.masterKey){if(t){n["X-LC-Sign"]=h(u.masterKey,true)}else{n["X-LC-Key"]=u.masterKey+",master"}}else{console.warn("masterKey is not set, fall back to use appKey");d(n,t)}}else{d(n,t)}if(u.hookKey){n["X-LC-Hook-Key"]=u.hookKey}if(u._config.production!==null){n["X-LC-Prod"]=String(u._config.production)}n[false?"User-Agent":"X-LC-UA"]=u._sharedConfig.userAgent;return a.resolve().then(function(){var t=f(e);if(t){n["X-LC-Session"]=t}else if(!u._config.disableCurrentUser){return u.User.currentAsync().then(function(e){if(e&&e._sessionToken){n["X-LC-Session"]=e._sessionToken}return n})}return n})};var v=function w(e){var t=e.service,n=t===undefined?"api":t,r=e.version,i=r===undefined?"1.1":r,s=e.path;var o=u._config.serverURLs[n];if(!o)throw new Error("undefined server URL for "+n);if(o.charAt(o.length-1)!=="/"){o+="/"}o+=i;if(s){o+=s}return o};var _=function O(e){var t=e.service,n=e.version,i=e.method,s=e.path,o=e.query,a=e.data,c=e.authOptions,f=e.signKey,h=f===undefined?true:f;if(!(u.applicationId&&(u.applicationKey||u.masterKey))){throw new Error("Not initialized")}u._appRouter.refresh();var d=u._config.requestTimeout;var _=v({service:t,path:s,version:n});return p(c,h).then(function(e){return l({method:i,url:_,query:o,data:a,headers:e,timeout:d}).catch(function(e){var t={code:e.code||-1,error:e.message||e.responseText};if(e.response&&e.response.code){t=e.response}else if(e.responseText){try{t=JSON.parse(e.responseText)}catch(n){}}t.rawMessage=t.rawMessage||t.error;if(!u._sharedConfig.keepErrorRawMessage){t.error+=" ["+(e.statusCode||"N/A")+" "+i+" "+_+"]"}var s=new Error(t.error);delete t.error;throw r.extend(s,t)})})};var y=function A(e,t,n,r,i,s,a){var u="";if(e)u+="/"+e;if(t)u+="/"+t;if(n)u+="/"+n;if(i&&i._fetchWhenSave)throw new Error("_fetchWhenSave should be in the query");if(i&&i._where)throw new Error("_where should be in the query");if(r&&r.toLowerCase()==="get"){a=o({},a,i);i=null}return _({method:r,path:u,query:a,data:i,authOptions:s})};u.request=_;e.exports={_request:y,request:_}},function(e,t,n){"use strict";var r=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=n(0);var s=n(8);var o=n(6);var a=o("leancloud:request");var u=o("leancloud:request:error");var c=n(1);var f=0;var l=function A(e){var t=e.method,n=e.url,i=e.query,l=e.data,h=e.headers,d=h===undefined?{}:h,p=e.onprogress,v=e.timeout;var _={};if(i){for(var y in i){var m=i[y];if(m===undefined)continue;if((typeof m==="undefined"?"undefined":r(m))==="object"){_[y]=JSON.stringify(m)}else{_[y]=m}}}var g=f++;a("request(%d) %s %s %o %o %o",g,t,n,_,l,d);return new c(function(e,r){var c=s(t,n).set(d).query(_).send(l);if(p){c.on("progress",p)}if(v){c.timeout(v)}c.end(function(s,c){if(s){if(c){if(!o.enabled("leancloud:request")){u("request(%d) %s %s %o %o %o",g,t,n,i,l,d)}u("response(%d) %d %O %o",g,c.status,c.body||c.text,c.header);s.statusCode=c.status;s.responseText=c.text;s.response=c.body}return r(s)}a("response(%d) %d %O %o",g,c.status,c.body||c.text,c.header);return e(c.body)})})};var h=function S(e){return i.isNull(e)||i.isUndefined(e)};var d=function C(e){if(i.isArray(e)){return e}if(e===undefined||e===null){return[]}return[e]};var p=function E(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.keys,n=e.include,r=e.includeACL;var i={};if(t){i.keys=d(t).join(",")}if(n){i.include=d(n).join(",")}if(r){i.returnACL=r}return i};var v=function T(e){if(e.sessionToken){return e.sessionToken}if(e.user&&typeof e.user.getSessionToken==="function"){return e.user.getSessionToken()}};var _=function N(e){return function(t){return e(t),t}};var y=function j(){};var m=function x(e,t,n){var r;if(t&&t.hasOwnProperty("constructor")){r=t.constructor}else{r=function s(){e.apply(this,arguments)}}i.extend(r,e);y.prototype=e.prototype;r.prototype=new y;if(t){i.extend(r.prototype,t)}if(n){i.extend(r,n)}r.prototype.constructor=r;r.__super__=e.prototype;return r};function g(e){var t=new RegExp("^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})"+"T"+"([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})"+"(.([0-9]+))?"+"Z$");var n=t.exec(e);if(!n){return null}var r=n[1]||0;var i=(n[2]||1)-1;var s=n[3]||0;var o=n[4]||0;var a=n[5]||0;var u=n[6]||0;var c=n[8]||0;return new Date(Date.UTC(r,i,s,o,a,u,c))}var b=function U(e,t,n){var r=t.split(".");var i=r.pop();var s=e;r.forEach(function(e){if(s[e]===undefined)s[e]={};s=s[e]});s[i]=n;return e};var w=function k(e,t){var n=t.split(".");var r=n[0];var i=n.pop();var s=e;for(var o=0;o<n.length;o++){s=s[n[o]];if(s===undefined){return[undefined,undefined,i]}}var a=s[i];return[a,s,i,r]};var O=function I(e){return i.isObject(e)&&Object.getPrototypeOf(e)===Object.prototype};e.exports={ajax:l,isNullOrUndefined:h,ensureArray:d,transformFetchOptions:p,getSessionToken:v,tap:_,inherits:m,parseDate:g,setValue:b,findValue:w,isPlainObject:O}},function(e,t,n){"use strict";var r=n(0);function i(e,t){var n=new Error(t);n.code=e;return n}r.extend(i,{OTHER_CAUSE:-1,INTERNAL_SERVER_ERROR:1,CONNECTION_FAILED:100,OBJECT_NOT_FOUND:101,INVALID_QUERY:102,INVALID_CLASS_NAME:103,MISSING_OBJECT_ID:104,INVALID_KEY_NAME:105,INVALID_POINTER:106,INVALID_JSON:107,COMMAND_UNAVAILABLE:108,NOT_INITIALIZED:109,INCORRECT_TYPE:111,INVALID_CHANNEL_NAME:112,PUSH_MISCONFIGURED:115,OBJECT_TOO_LARGE:116,OPERATION_FORBIDDEN:119,CACHE_MISS:120,INVALID_NESTED_KEY:121,INVALID_FILE_NAME:122,INVALID_ACL:123,TIMEOUT:124,INVALID_EMAIL_ADDRESS:125,MISSING_CONTENT_TYPE:126,MISSING_CONTENT_LENGTH:127,INVALID_CONTENT_LENGTH:128,FILE_TOO_LARGE:129,FILE_SAVE_ERROR:130,FILE_DELETE_ERROR:153,DUPLICATE_VALUE:137,INVALID_ROLE_NAME:139,EXCEEDED_QUOTA:140,SCRIPT_FAILED:141,VALIDATION_ERROR:142,INVALID_IMAGE_DATA:150,UNSAVED_FILE_ERROR:151,INVALID_PUSH_TIME_ERROR:152,USERNAME_MISSING:200,PASSWORD_MISSING:201,USERNAME_TAKEN:202,EMAIL_TAKEN:203,EMAIL_MISSING:204,EMAIL_NOT_FOUND:205,SESSION_MISSING:206,MUST_CREATE_USER_THROUGH_SIGNUP:207,ACCOUNT_ALREADY_LINKED:208,LINKED_ID_MISSING:250,INVALID_LINKED_SESSION:251,UNSUPPORTED_SERVICE:252,X_DOMAIN_REQUEST:602});e.exports=i},function(e,t,n){"use strict";(function(t){var r=n(0);var i=n(9);var s=n(20);var o=n(3),a=o.inherits,u=o.parseDate;var c=n(1);var f=t.AV||{};f._config={serverURLs:{},useMasterKey:false,production:null,realtime:null,requestTimeout:null};f._sharedConfig={userAgent:s,liveQueryRealtime:null};f._getAVPath=function(e){if(!f.applicationId){throw new Error("You need to call AV.initialize before using AV.")}if(!e){e=""}if(!r.isString(e)){throw new Error("Tried to get a localStorage path that wasn't a String.")}if(e[0]==="/"){e=e.substring(1)}return"AV/"+f.applicationId+"/"+e};f._installationId=null;f._getInstallationId=function(){if(f._installationId){return c.resolve(f._installationId)}var e=f._getAVPath("installationId");return f.localStorage.getItemAsync(e).then(function(t){f._installationId=t;if(!f._installationId){f._installationId=t=i();return f.localStorage.setItemAsync(e,t).then(function(){return t})}return t})};f._subscriptionId=null;f._refreshSubscriptionId=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:f._getAVPath("subscriptionId");var t=f._subscriptionId=i();return f.localStorage.setItemAsync(e,t).then(function(){return t})};f._getSubscriptionId=function(){if(f._subscriptionId){return c.resolve(f._subscriptionId)}var e=f._getAVPath("subscriptionId");return f.localStorage.getItemAsync(e).then(function(t){f._subscriptionId=t;if(!f._subscriptionId){t=f._refreshSubscriptionId(e)}return t})};f._parseDate=u;f._extend=function(e,t){var n=a(this,e,t);n.extend=this.extend;return n};f._encode=function(e,t,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if(e instanceof f.Object){if(n){throw new Error("AV.Objects not allowed here")}if(!t||r.include(t,e)||!e._hasData){return e._toPointer()}return e._toFullJSON(t.concat(e),i)}if(e instanceof f.ACL){return e.toJSON()}if(r.isDate(e)){return i?{__type:"Date",iso:e.toJSON()}:e.toJSON()}if(e instanceof f.GeoPoint){return e.toJSON()}if(r.isArray(e)){return r.map(e,function(e){return f._encode(e,t,n,i)})}if(r.isRegExp(e)){return e.source}if(e instanceof f.Relation){return e.toJSON()}if(e instanceof f.Op){return e.toJSON()}if(e instanceof f.File){if(!e.url()&&!e.id){throw new Error("Tried to save an object containing an unsaved file.")}return e._toFullJSON(t,i)}if(r.isObject(e)){return r.mapObject(e,function(e,r){return f._encode(e,t,n,i)})}return e};f._decode=function(e,t){if(!r.isObject(e)||r.isDate(e)){return e}if(r.isArray(e)){return r.map(e,function(e){return f._decode(e)})}if(e instanceof f.Object){return e}if(e instanceof f.File){return e}if(e instanceof f.Op){return e}if(e instanceof f.GeoPoint){return e}if(e instanceof f.ACL){return e}if(t==="ACL"){return new f.ACL(e)}if(e.__op){return f.Op._decode(e)}var n;if(e.__type==="Pointer"){n=e.className;var i=f.Object._create(n);if(Object.keys(e).length>3){var s=r.clone(e);delete s.__type;delete s.className;i._finishFetch(s,true)}else{i._finishFetch({objectId:e.objectId},false)}return i}if(e.__type==="Object"){n=e.className;var o=r.clone(e);delete o.__type;delete o.className;var a=f.Object._create(n);a._finishFetch(o,true);return a}if(e.__type==="Date"){return f._parseDate(e.iso)}if(e.__type==="GeoPoint"){return new f.GeoPoint({latitude:e.latitude,longitude:e.longitude})}if(e.__type==="Relation"){if(!t)throw new Error("key missing decoding a Relation");var u=new f.Relation(null,t);u.targetClassName=e.className;return u}if(e.__type==="File"){var c=new f.File(e.name);var l=r.clone(e);delete l.__type;c._finishFetch(l);return c}return r.mapObject(e,f._decode)};f.parseJSON=f._decode;f._encodeObjectOrArray=function(e){var t=function n(e){if(e&&e._toFullJSON){e=e._toFullJSON([])}return r.mapObject(e,function(e){return f._encode(e,[])})};if(r.isArray(e)){return e.map(function(e){return t(e)})}else{return t(e)}};f._arrayEach=r.each;f._traverse=function(e,t,n){if(e instanceof f.Object){n=n||[];if(r.indexOf(n,e)>=0){return}n.push(e);f._traverse(e.attributes,t,n);return t(e)}if(e instanceof f.Relation||e instanceof f.File){return t(e)}if(r.isArray(e)){r.each(e,function(r,i){var s=f._traverse(r,t,n);if(s){e[i]=s}});return t(e)}if(r.isObject(e)){f._each(e,function(r,i){var s=f._traverse(r,t,n);if(s){e[i]=s}});return t(e)}return t(e)};f._objectEach=f._each=function(e,t){if(r.isObject(e)){r.each(r.keys(e),function(n){t(e[n],n)})}else{r.each(e,t)}};e.exports=f}).call(t,n(7))},function(e,t,n){"use strict";function r(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){r=function t(e){return typeof e}}else{r=function n(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return r(e)}t.log=o;t.formatArgs=s;t.save=a;t.load=u;t.useColors=i;t.storage=c();t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];
function i(){if(typeof window!=="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)){return true}if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)){return false}return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function s(t){t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff);if(!this.useColors){return}var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0;var i=0;t[0].replace(/%[a-zA-Z%]/g,function(e){if(e==="%%"){return}r++;if(e==="%c"){i=r}});t.splice(i,0,n)}function o(){var e;return(typeof console==="undefined"?"undefined":r(console))==="object"&&console.log&&(e=console).log.apply(e,arguments)}function a(e){try{if(e){t.storage.setItem("debug",e)}else{t.storage.removeItem("debug")}}catch(n){}}function u(){var e;try{e=t.storage.getItem("debug")}catch(n){}if(!e&&typeof process!=="undefined"&&"env"in process){e=process.env.DEBUG}return e}function c(){try{return localStorage}catch(e){}}e.exports=n(27)(t);var f=e.exports.formatters;f.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(1,eval)("this")}catch(r){if(typeof window==="object")n=window}e.exports=n},function(e,t,n){var r;if(typeof window!=="undefined"){r=window}else if(typeof self!=="undefined"){r=self}else{console.warn("Using browser-only version of superagent in non-browser environment");r=this}var i=n(22);var s=n(23);var o=n(11);var a=n(24);var u=n(26);function c(){}var f=t=e.exports=function(e,n){if("function"==typeof n){return new t.Request("GET",e).end(n)}if(1==arguments.length){return new t.Request("GET",e)}return new t.Request(e,n)};t.Request=m;f.getXHR=function(){if(r.XMLHttpRequest&&(!r.location||"file:"!=r.location.protocol||!r.ActiveXObject)){return new XMLHttpRequest}else{try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}throw Error("Browser-only version of superagent could not find XHR")};var l="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};function h(e){if(!o(e))return e;var t=[];for(var n in e){d(t,n,e[n])}return t.join("&")}function d(e,t,n){if(n!=null){if(Array.isArray(n)){n.forEach(function(n){d(e,t,n)})}else if(o(n)){for(var r in n){d(e,t+"["+r+"]",n[r])}}else{e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}}else if(n===null){e.push(encodeURIComponent(t))}}f.serializeObject=h;function p(e){var t={};var n=e.split("&");var r;var i;for(var s=0,o=n.length;s<o;++s){r=n[s];i=r.indexOf("=");if(i==-1){t[decodeURIComponent(r)]=""}else{t[decodeURIComponent(r.slice(0,i))]=decodeURIComponent(r.slice(i+1))}}return t}f.parseString=p;f.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"};f.serialize={"application/x-www-form-urlencoded":h,"application/json":JSON.stringify};f.parse={"application/x-www-form-urlencoded":p,"application/json":JSON.parse};function v(e){var t=e.split(/\r?\n/);var n={};var r;var i;var s;var o;for(var a=0,u=t.length;a<u;++a){i=t[a];r=i.indexOf(":");if(r===-1){continue}s=i.slice(0,r).toLowerCase();o=l(i.slice(r+1));n[s]=o}return n}function _(e){return/[\/+]json($|[^-\w])/.test(e)}function y(e){this.req=e;this.xhr=this.req.xhr;this.text=this.req.method!="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType==="undefined"?this.xhr.responseText:null;this.statusText=this.req.xhr.statusText;var t=this.xhr.status;if(t===1223){t=204}this._setStatusProperties(t);this.header=this.headers=v(this.xhr.getAllResponseHeaders());this.header["content-type"]=this.xhr.getResponseHeader("content-type");this._setHeaderProperties(this.header);if(null===this.text&&e._responseType){this.body=this.xhr.response}else{this.body=this.req.method!="HEAD"?this._parseBody(this.text?this.text:this.xhr.response):null}}a(y.prototype);y.prototype._parseBody=function(e){var t=f.parse[this.type];if(this.req._parser){return this.req._parser(this,e)}if(!t&&_(this.type)){t=f.parse["application/json"]}return t&&e&&(e.length||e instanceof Object)?t(e):null};y.prototype.toError=function(){var e=this.req;var t=e.method;var n=e.url;var r="cannot "+t+" "+n+" ("+this.status+")";var i=new Error(r);i.status=this.status;i.method=t;i.url=n;return i};f.Response=y;function m(e,t){var n=this;this._query=this._query||[];this.method=e;this.url=t;this.header={};this._header={};this.on("end",function(){var e=null;var t=null;try{t=new y(n)}catch(r){e=new Error("Parser is unable to parse the response");e.parse=true;e.original=r;if(n.xhr){e.rawResponse=typeof n.xhr.responseType=="undefined"?n.xhr.responseText:n.xhr.response;e.status=n.xhr.status?n.xhr.status:null;e.statusCode=e.status}else{e.rawResponse=null;e.status=null}return n.callback(e)}n.emit("response",t);var i;try{if(!n._isResponseOK(t)){i=new Error(t.statusText||"Unsuccessful HTTP response")}}catch(s){i=s}if(i){i.original=e;i.response=t;i.status=t.status;n.callback(i,t)}else{n.callback(null,t)}})}i(m.prototype);s(m.prototype);m.prototype.type=function(e){this.set("Content-Type",f.types[e]||e);return this};m.prototype.accept=function(e){this.set("Accept",f.types[e]||e);return this};m.prototype.auth=function(e,t,n){if(1===arguments.length)t="";if(typeof t==="object"&&t!==null){n=t;t=""}if(!n){n={type:"function"===typeof btoa?"basic":"auto"}}var r=function(e){if("function"===typeof btoa){return btoa(e)}throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(e,t,n,r)};m.prototype.query=function(e){if("string"!=typeof e)e=h(e);if(e)this._query.push(e);return this};m.prototype.attach=function(e,t,n){if(t){if(this._data){throw Error("superagent can't mix .send() and .attach()")}this._getFormData().append(e,t,n||t.name)}return this};m.prototype._getFormData=function(){if(!this._formData){this._formData=new r.FormData}return this._formData};m.prototype.callback=function(e,t){if(this._shouldRetry(e,t)){return this._retry()}var n=this._callback;this.clearTimeout();if(e){if(this._maxRetries)e.retries=this._retries-1;this.emit("error",e)}n(e,t)};m.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=true;e.status=this.status;e.method=this.method;e.url=this.url;this.callback(e)};m.prototype.buffer=m.prototype.ca=m.prototype.agent=function(){console.warn("This is not supported in browser version of superagent");return this};m.prototype.pipe=m.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")};m.prototype._isHost=function b(e){return e&&"object"===typeof e&&!Array.isArray(e)&&Object.prototype.toString.call(e)!=="[object Object]"};m.prototype.end=function(e){if(this._endCalled){console.warn("Warning: .end() was called twice. This is not supported in superagent")}this._endCalled=true;this._callback=e||c;this._finalizeQueryString();return this._end()};m.prototype._end=function(){var e=this;var t=this.xhr=f.getXHR();var n=this._formData||this._data;this._setTimeouts();t.onreadystatechange=function(){var n=t.readyState;if(n>=2&&e._responseTimeoutTimer){clearTimeout(e._responseTimeoutTimer)}if(4!=n){return}var r;try{r=t.status}catch(i){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")};var r=function(t,n){if(n.total>0){n.percent=n.loaded/n.total*100}n.direction=t;e.emit("progress",n)};if(this.hasListeners("progress")){try{t.onprogress=r.bind(null,"download");if(t.upload){t.upload.onprogress=r.bind(null,"upload")}}catch(i){}}try{if(this.username&&this.password){t.open(this.method,this.url,true,this.username,this.password)}else{t.open(this.method,this.url,true)}}catch(s){return this.callback(s)}if(this._withCredentials)t.withCredentials=true;if(!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof n&&!this._isHost(n)){var o=this._header["content-type"];var a=this._serializer||f.serialize[o?o.split(";")[0]:""];if(!a&&_(o)){a=f.serialize["application/json"]}if(a)n=a(n)}for(var u in this.header){if(null==this.header[u])continue;if(this.header.hasOwnProperty(u))t.setRequestHeader(u,this.header[u])}if(this._responseType){t.responseType=this._responseType}this.emit("request",this);t.send(typeof n!=="undefined"?n:null);return this};f.agent=function(){return new u};["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(e){u.prototype[e.toLowerCase()]=function(t,n){var r=new f.Request(e,t);this._setDefaults(r);if(n){r.end(n)}return r}});u.prototype.del=u.prototype["delete"];f.get=function(e,t,n){var r=f("GET",e);if("function"==typeof t)n=t,t=null;if(t)r.query(t);if(n)r.end(n);return r};f.head=function(e,t,n){var r=f("HEAD",e);if("function"==typeof t)n=t,t=null;if(t)r.query(t);if(n)r.end(n);return r};f.options=function(e,t,n){var r=f("OPTIONS",e);if("function"==typeof t)n=t,t=null;if(t)r.send(t);if(n)r.end(n);return r};function g(e,t,n){var r=f("DELETE",e);if("function"==typeof t)n=t,t=null;if(t)r.send(t);if(n)r.end(n);return r}f["del"]=g;f["delete"]=g;f.patch=function(e,t,n){var r=f("PATCH",e);if("function"==typeof t)n=t,t=null;if(t)r.send(t);if(n)r.end(n);return r};f.post=function(e,t,n){var r=f("POST",e);if("function"==typeof t)n=t,t=null;if(t)r.send(t);if(n)r.end(n);return r};f.put=function(e,t,n){var r=f("PUT",e);if("function"==typeof t)n=t,t=null;if(t)r.send(t);if(n)r.end(n);return r}},function(e,t,n){var r=n(18);var i=n(19);function s(e,t,n){var s=t&&n||0;if(typeof e=="string"){t=e==="binary"?new Array(16):null;e=null}e=e||{};var o=e.random||(e.rng||r)();o[6]=o[6]&15|64;o[8]=o[8]&63|128;if(t){for(var a=0;a<16;++a){t[s+a]=o[a]}}return t||i(o)}e.exports=s},function(e,t,n){"use strict";e.exports="3.13.2"},function(e,t,n){"use strict";function r(e){return null!==e&&"object"===typeof e}e.exports=r},function(e,t,n){"use strict";var r=n(0);var i=n(1);var s=n(31);var o=["getItem","setItem","removeItem","clear"];if(!s.async){r(o).each(function(e){if(typeof s[e]==="function"){s[e+"Async"]=function(){return i.resolve(s[e].apply(s,arguments))}}})}else{r(o).each(function(e){if(typeof s[e]!=="function"){s[e]=function(){var t=new Error("Synchronous API ["+e+"] is not available in this runtime.");t.code="SYNC_API_NOT_AVAILABLE";throw t}}})}e.exports=s},function(e,t,n){"use strict";var r=n(12);var i=n(5);var s=t.removeAsync=r.removeItemAsync.bind(r);var o=function a(e,t){try{e=JSON.parse(e)}catch(n){return null}if(e){var r=e.expiredAt&&e.expiredAt<Date.now();if(!r){return e.value}return s(t).then(function(){return null})}return null};t.getAsync=function(e){e="AV/"+i.applicationId+"/"+e;return r.getItemAsync(e).then(function(t){return o(t,e)})};t.setAsync=function(e,t,n){var s={value:t};if(typeof n==="number"){s.expiredAt=Date.now()+n}return r.setItemAsync("AV/"+i.applicationId+"/"+e,JSON.stringify(s))}},function(e,t){var n={utf8:{stringToBytes:function(e){return n.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(n.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n)&255);return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=n},function(e,t,n){"use strict";n(16);var r=n(0);var i=n(5);i._=r;i.version=n(10);i.Promise=n(1);i.localStorage=n(12);i.Cache=n(13);i.Error=n(4);n(33);n(35)(i);n(36)(i);n(37)(i);n(38)(i);n(39)(i);n(40)(i);n(48)(i);n(49)(i);n(50)(i);n(51)(i);n(52)(i);n(54)(i);n(55)(i);n(56)(i);n(57)(i);n(58)(i);n(59)(i);i.Conversation=n(60);n(61);e.exports=i},function(e,t,n){"use strict"},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){e.deprecate=function(){};e.paths=[];if(!e.children)e.children=[];Object.defineProperty(e,"loaded",{enumerable:true,get:function(){return e.l}});Object.defineProperty(e,"id",{enumerable:true,get:function(){return e.i}});e.webpackPolyfill=1}return e}},function(e,t){var n=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function s(){n(r);return r}}else{var i=new Array(16);e.exports=function o(){for(var e=0,t;e<16;e++){if((e&3)===0)t=Math.random()*4294967296;i[e]=t>>>((e&3)<<3)&255}return i}}},function(e,t){var n=[];for(var r=0;r<256;++r){n[r]=(r+256).toString(16).substr(1)}function i(e,t){var r=t||0;var i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}e.exports=i},function(e,t,n){"use strict";var r=n(10);var i=["Browser"||"Node.js"].concat(n(21));e.exports="LeanCloud-JS-SDK/"+r+" ("+i.join("; ")+")"},function(e,t,n){"use strict";e.exports=[]},function(e,t,n){if(true){e.exports=r}function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype){e[t]=r.prototype[t]}return e}r.prototype.on=r.prototype.addEventListener=function(e,t){this._callbacks=this._callbacks||{};(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t);return this};r.prototype.once=function(e,t){function n(){this.off(e,n);t.apply(this,arguments)}n.fn=t;this.on(e,n);return this};r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length){delete this._callbacks["$"+e];return this}var r;for(var i=0;i<n.length;i++){r=n[i];if(r===t||r.fn===t){n.splice(i,1);break}}if(n.length===0){delete this._callbacks["$"+e]}return this};r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=new Array(arguments.length-1),n=this._callbacks["$"+e];for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r){n[r].apply(this,t)}}return this};r.prototype.listeners=function(e){this._callbacks=this._callbacks||{};return this._callbacks["$"+e]||[]};r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";var r=n(11);e.exports=i;function i(e){if(e)return s(e)}function s(e){for(var t in i.prototype){e[t]=i.prototype[t]}return e}i.prototype.clearTimeout=function a(){clearTimeout(this._timer);clearTimeout(this._responseTimeoutTimer);delete this._timer;delete this._responseTimeoutTimer;return this};i.prototype.parse=function u(e){this._parser=e;return this};i.prototype.responseType=function(e){this._responseType=e;return this};i.prototype.serialize=function c(e){this._serializer=e;return this};i.prototype.timeout=function f(e){if(!e||"object"!==typeof e){this._timeout=e;this._responseTimeout=0;return this}for(var t in e){switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;default:console.warn("Unknown timeout option",t)}}return this};i.prototype.retry=function l(e,t){if(arguments.length===0||e===true)e=1;if(e<=0)e=0;this._maxRetries=e;this._retries=0;this._retryCallback=t;return this};var o=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];i.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries){return false}if(this._retryCallback){try{var n=this._retryCallback(e,t);if(n===true)return true;if(n===false)return false}catch(r){console.error(r)}}if(t&&t.status&&t.status>=500&&t.status!=501)return true;if(e){if(e.code&&~o.indexOf(e.code))return true;if(e.timeout&&e.code=="ECONNABORTED")return true;if(e.crossDomain)return true}return false};i.prototype._retry=function(){this.clearTimeout();if(this.req){this.req=null;this.req=this.request()}this._aborted=false;this.timedout=false;return this._end()};i.prototype.then=function h(e,t){if(!this._fullfilledPromise){var n=this;if(this._endCalled){console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises")}this._fullfilledPromise=new Promise(function(e,t){n.end(function(n,r){if(n)t(n);else e(r)})})}return this._fullfilledPromise.then(e,t)};i.prototype["catch"]=function(e){return this.then(undefined,e)};i.prototype.use=function d(e){e(this);return this};i.prototype.ok=function(e){if("function"!==typeof e)throw Error("Callback required");this._okCallback=e;return this};i.prototype._isResponseOK=function(e){if(!e){return false}if(this._okCallback){return this._okCallback(e)}return e.status>=200&&e.status<300};i.prototype.get=function(e){return this._header[e.toLowerCase()]};i.prototype.getHeader=i.prototype.get;i.prototype.set=function(e,t){if(r(e)){for(var n in e){this.set(n,e[n])}return this}this._header[e.toLowerCase()]=t;this.header[e]=t;return this};i.prototype.unset=function(e){delete this._header[e.toLowerCase()];delete this.header[e];return this};i.prototype.field=function(e,t){if(null===e||undefined===e){throw new Error(".field(name, val) name can not be empty")}if(this._data){console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()")}if(r(e)){for(var n in e){this.field(n,e[n])}return this}if(Array.isArray(t)){for(var i in t){this.field(e,t[i])}return this}if(null===t||undefined===t){throw new Error(".field(name, val) val can not be empty")}if("boolean"===typeof t){t=""+t}this._getFormData().append(e,t);return this};i.prototype.abort=function(){if(this._aborted){return this}this._aborted=true;this.xhr&&this.xhr.abort();this.req&&this.req.abort();this.clearTimeout();this.emit("abort");return this};i.prototype._auth=function(e,t,n,r){switch(n.type){case"basic":this.set("Authorization","Basic "+r(e+":"+t));break;case"auto":this.username=e;this.password=t;break;case"bearer":this.set("Authorization","Bearer "+e);break}return this};i.prototype.withCredentials=function(e){if(e==undefined)e=true;this._withCredentials=e;return this};i.prototype.redirects=function(e){this._maxRedirects=e;return this};i.prototype.maxResponseSize=function(e){if("number"!==typeof e){throw TypeError("Invalid argument")}this._maxResponseSize=e;return this};i.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}};i.prototype.send=function(e){var t=r(e);var n=this._header["content-type"];if(this._formData){console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()")}if(t&&!this._data){if(Array.isArray(e)){this._data=[]}else if(!this._isHost(e)){this._data={}}}else if(e&&this._data&&this._isHost(this._data)){throw Error("Can't merge these send calls")}if(t&&r(this._data)){for(var i in e){this._data[i]=e[i]}}else if("string"==typeof e){if(!n)this.type("form");n=this._header["content-type"];if("application/x-www-form-urlencoded"==n){this._data=this._data?this._data+"&"+e:e}else{this._data=(this._data||"")+e}}else{this._data=e}if(!t||this._isHost(e)){return this}if(!n)this.type("json");return this};i.prototype.sortQuery=function(e){this._sort=typeof e==="undefined"?true:e;return this};i.prototype._finalizeQueryString=function(){var e=this._query.join("&");if(e){this.url+=(this.url.indexOf("?")>=0?"&":"?")+e}this._query.length=0;if(this._sort){var t=this.url.indexOf("?");if(t>=0){var n=this.url.substring(t+1).split("&");if("function"===typeof this._sort){n.sort(this._sort)}else{n.sort()}this.url=this.url.substring(0,t)+"?"+n.join("&")}}};i.prototype._appendQueryString=function(){console.trace("Unsupported")};i.prototype._timeoutError=function(e,t,n){if(this._aborted){return}var r=new Error(e+t+"ms exceeded");r.timeout=t;r.code="ECONNABORTED";r.errno=n;this.timedout=true;this.abort();this.callback(r)};i.prototype._setTimeouts=function(){var e=this;if(this._timeout&&!this._timer){this._timer=setTimeout(function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")},this._timeout)}if(this._responseTimeout&&!this._responseTimeoutTimer){this._responseTimeoutTimer=setTimeout(function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")},this._responseTimeout)}}},function(e,t,n){"use strict";var r=n(25);e.exports=i;function i(e){if(e)return s(e)}function s(e){for(var t in i.prototype){e[t]=i.prototype[t]}return e}i.prototype.get=function(e){return this.header[e.toLowerCase()]};i.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=r.type(t);var n=r.params(t);for(var i in n)this[i]=n[i];this.links={};try{if(e.link){this.links=r.parseLinks(e.link)}}catch(s){}};i.prototype._setStatusProperties=function(e){var t=e/100|0;this.status=this.statusCode=e;this.statusType=t;this.info=1==t;this.ok=2==t;this.redirect=3==t;this.clientError=4==t;this.serverError=5==t;this.error=4==t||5==t?this.toError():false;this.created=201==e;this.accepted=202==e;this.noContent=204==e;this.badRequest=400==e;this.unauthorized=401==e;this.notAcceptable=406==e;this.forbidden=403==e;this.notFound=404==e;this.unprocessableEntity=422==e}},function(e,t,n){"use strict";t.type=function(e){return e.split(/ *; */).shift()};t.params=function(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */);var r=n.shift();var i=n.shift();if(r&&i)e[r]=i;return e},{})};t.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var n=t.split(/ *; */);var r=n[0].slice(1,-1);var i=n[1].split(/ *= */)[1].slice(1,-1);e[i]=r;return e},{})};t.cleanHeader=function(e,t){delete e["content-type"];delete e["content-length"];delete e["transfer-encoding"];delete e["host"];if(t){delete e["authorization"];delete e["cookie"]}return e}},function(e,t){function n(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(e){n.prototype[e]=function(){this._defaults.push({fn:e,arguments:arguments});return this}});n.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,t.arguments)})};e.exports=n},function(e,t,n){"use strict";function r(e){r.debug=r;r.default=r;r.coerce=c;r.disable=a;r.enable=o;r.enabled=u;r.humanize=n(28);Object.keys(e).forEach(function(t){r[t]=e[t]});r.instances=[];r.names=[];r.skips=[];r.formatters={};function t(e){var t=0;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n);t|=0}return r.colors[Math.abs(t)%r.colors.length]}r.selectColor=t;function r(e){var n;function o(){if(!o.enabled){return}for(var e=arguments.length,t=new Array(e),i=0;i<e;i++){t[i]=arguments[i]}var s=o;var a=Number(new Date);var u=a-(n||a);s.diff=u;s.prev=n;s.curr=a;n=a;t[0]=r.coerce(t[0]);if(typeof t[0]!=="string"){t.unshift("%O")}var c=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(e,n){if(e==="%%"){return e}c++;var i=r.formatters[n];if(typeof i==="function"){var o=t[c];e=i.call(s,o);t.splice(c,1);c--}return e});r.formatArgs.call(s,t);var f=s.log||r.log;f.apply(s,t)}o.namespace=e;o.enabled=r.enabled(e);o.useColors=r.useColors();o.color=t(e);o.destroy=i;o.extend=s;if(typeof r.init==="function"){r.init(o)}r.instances.push(o);return o}function i(){var e=r.instances.indexOf(this);if(e!==-1){r.instances.splice(e,1);return true}return false}function s(e,t){return r(this.namespace+(typeof t==="undefined"?":":t)+e)}function o(e){r.save(e);r.names=[];r.skips=[];var t;var n=(typeof e==="string"?e:"").split(/[\s,]+/);var i=n.length;for(t=0;t<i;t++){if(!n[t]){continue}e=n[t].replace(/\*/g,".*?");if(e[0]==="-"){r.skips.push(new RegExp("^"+e.substr(1)+"$"))}else{r.names.push(new RegExp("^"+e+"$"))}}for(t=0;t<r.instances.length;t++){var s=r.instances[t];s.enabled=r.enabled(s.namespace)}}function a(){r.enable("")}function u(e){if(e[e.length-1]==="*"){return true}var t;var n;for(t=0,n=r.skips.length;t<n;t++){if(r.skips[t].test(e)){return false}}for(t=0,n=r.names.length;t<n;t++){if(r.names[t].test(e)){return true}}return false}function c(e){if(e instanceof Error){return e.stack||e.message}return e}r.enable(r.load());return r}e.exports=r},function(e,t){var n=1e3;var r=n*60;var i=r*60;var s=i*24;var o=s*7;var a=s*365.25;e.exports=function(e,t){t=t||{};var n=typeof e;if(n==="string"&&e.length>0){return u(e)}else if(n==="number"&&isNaN(e)===false){return t.long?f(e):c(e)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function u(e){e=String(e);if(e.length>100){return}var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t){return}var u=parseFloat(t[1]);var c=(t[2]||"ms").toLowerCase();switch(c){case"years":case"year":case"yrs":case"yr":case"y":return u*a;case"weeks":case"week":case"w":return u*o;case"days":case"day":case"d":return u*s;case"hours":case"hour":case"hrs":case"hr":case"h":return u*i;case"minutes":case"minute":case"mins":case"min":case"m":return u*r;case"seconds":case"second":case"secs":case"sec":case"s":return u*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return undefined}}function c(e){var t=Math.abs(e);if(t>=s){return Math.round(e/s)+"d"}if(t>=i){return Math.round(e/i)+"h"}if(t>=r){return Math.round(e/r)+"m"}if(t>=n){return Math.round(e/n)+"s"}return e+"ms"}function f(e){var t=Math.abs(e);if(t>=s){return l(e,t,s,"day")}if(t>=i){return l(e,t,i,"hour")}if(t>=r){return l(e,t,r,"minute")}if(t>=n){return l(e,t,n,"second")}return e+" ms"}function l(e,t,n,r){var i=t>=n*1.5;return Math.round(e/n)+" "+r+(i?"s":"")}},function(e,t,n){(function(t){var r;(function(t,n){true?e.exports=n():typeof define==="function"&&define.amd?define(n):t.ES6Promise=n()})(this,function(){"use strict";function e(e){var t=typeof e;return e!==null&&(t==="object"||t==="function")}function i(e){return typeof e==="function"}var s=void 0;if(Array.isArray){s=Array.isArray}else{s=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}var o=s;var a=0;var u=void 0;var c=void 0;var f=function ce(e,t){A[a]=e;A[a+1]=t;a+=2;if(a===2){if(c){c(S)}else{E()}}};function l(e){c=e}function h(e){f=e}var d=typeof window!=="undefined"?window:undefined;var p=d||{};var v=p.MutationObserver||p.WebKitMutationObserver;var _=typeof self==="undefined"&&typeof process!=="undefined"&&{}.toString.call(process)==="[object process]";var y=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function m(){return function(){return process.nextTick(S)}}function g(){if(typeof u!=="undefined"){return function(){u(S)}}return O()}function b(){var e=0;var t=new v(S);var n=document.createTextNode("");t.observe(n,{characterData:true});return function(){n.data=e=++e%2}}function w(){var e=new MessageChannel;e.port1.onmessage=S;return function(){return e.port2.postMessage(0)}}function O(){var e=setTimeout;return function(){return e(S,1)}}var A=new Array(1e3);function S(){for(var e=0;e<a;e+=2){var t=A[e];var n=A[e+1];t(n);A[e]=undefined;A[e+1]=undefined}a=0}function C(){try{var e=r;var t=n(30);u=t.runOnLoop||t.runOnContext;return g()}catch(i){return O()}}var E=void 0;if(_){E=m()}else if(v){E=b()}else if(y){E=w()}else if(d===undefined&&"function"==="function"){E=C()}else{E=O()}function T(e,t){var n=this;var r=new this.constructor(x);if(r[j]===undefined){Z(r)}var i=n._state;if(i){var s=arguments[i-1];f(function(){return H(i,r,s,n._result)})}else{K(n,r,e,t)}return r}function N(e){var t=this;if(e&&typeof e==="object"&&e.constructor===t){return e}var n=new t(x);B(n,e);return n}var j=Math.random().toString(36).substring(2);function x(){}var U=void 0;var k=1;var I=2;var R={error:null};function D(){return new TypeError("You cannot resolve a promise with itself")}function P(){return new TypeError("A promises callback cannot return that same promise.")}function L(e){try{return e.then}catch(t){R.error=t;return R}}function F(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function q(e,t,n){f(function(e){var r=false;var i=F(n,t,function(n){if(r){return}r=true;if(t!==n){B(e,n)}else{Q(e,n)}},function(t){if(r){return}r=true;V(e,t)},"Settle: "+(e._label||" unknown promise"));if(!r&&i){r=true;V(e,i)}},e)}function M(e,t){if(t._state===k){Q(e,t._result)}else if(t._state===I){V(e,t._result)}else{K(t,undefined,function(t){return B(e,t)},function(t){return V(e,t)})}}function W(e,t,n){if(t.constructor===e.constructor&&n===T&&t.constructor.resolve===N){M(e,t)}else{if(n===R){V(e,R.error);R.error=null}else if(n===undefined){Q(e,t)}else if(i(n)){q(e,t,n)}else{Q(e,t)}}}function B(t,n){if(t===n){V(t,D())}else if(e(n)){W(t,n,L(n))}else{Q(t,n)}}function J(e){if(e._onerror){e._onerror(e._result)}z(e)}function Q(e,t){if(e._state!==U){return}e._result=t;e._state=k;if(e._subscribers.length!==0){f(z,e)}}function V(e,t){if(e._state!==U){return}e._state=I;e._result=t;f(J,e)}function K(e,t,n,r){var i=e._subscribers;var s=i.length;e._onerror=null;i[s]=t;i[s+k]=n;i[s+I]=r;if(s===0&&e._state){f(z,e)}}function z(e){var t=e._subscribers;var n=e._state;if(t.length===0){return}var r=void 0,i=void 0,s=e._result;for(var o=0;o<t.length;o+=3){r=t[o];i=t[o+n];if(r){H(n,r,i,s)}else{i(s)}}e._subscribers.length=0}function G(e,t){try{return e(t)}catch(n){R.error=n;return R}}function H(e,t,n,r){var s=i(n),o=void 0,a=void 0,u=void 0,c=void 0;if(s){o=G(n,r);if(o===R){c=true;a=o.error;o.error=null}else{u=true}if(t===o){V(t,P());return}}else{o=r;u=true}if(t._state!==U){}else if(s&&u){B(t,o)}else if(c){V(t,a)}else if(e===k){Q(t,o)}else if(e===I){V(t,o)}}function $(e,t){try{t(function r(t){B(e,t)},function i(t){V(e,t)})}catch(n){V(e,n)}}var X=0;function Y(){return X++}function Z(e){e[j]=X++;e._state=undefined;e._result=undefined;e._subscribers=[]}function ee(){return new Error("Array Methods must be provided an Array")}var te=function(){function e(e,t){this._instanceConstructor=e;this.promise=new e(x);if(!this.promise[j]){Z(this.promise)}if(o(t)){this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(this.length===0){Q(this.promise,this._result)}else{this.length=this.length||0;this._enumerate(t);if(this._remaining===0){Q(this.promise,this._result)}}}else{V(this.promise,ee())}}e.prototype._enumerate=function t(e){for(var t=0;this._state===U&&t<e.length;t++){this._eachEntry(e[t],t)}};e.prototype._eachEntry=function n(e,t){var n=this._instanceConstructor;var r=n.resolve;if(r===N){var i=L(e);if(i===T&&e._state!==U){this._settledAt(e._state,t,e._result)}else if(typeof i!=="function"){this._remaining--;this._result[t]=e}else if(n===ae){var s=new n(x);W(s,e,i);this._willSettleAt(s,t)}else{this._willSettleAt(new n(function(t){return t(e)}),t)}}else{this._willSettleAt(r(e),t)}};e.prototype._settledAt=function r(e,t,n){var r=this.promise;if(r._state===U){this._remaining--;if(e===I){V(r,n)}else{this._result[t]=n}}if(this._remaining===0){Q(r,this._result)}};e.prototype._willSettleAt=function i(e,t){var n=this;K(e,undefined,function(e){return n._settledAt(k,t,e)},function(e){return n._settledAt(I,t,e)})};return e}();function ne(e){
return new te(this,e).promise}function re(e){var t=this;if(!o(e)){return new t(function(e,t){return t(new TypeError("You must pass an array to race."))})}else{return new t(function(n,r){var i=e.length;for(var s=0;s<i;s++){t.resolve(e[s]).then(n,r)}})}}function ie(e){var t=this;var n=new t(x);V(n,e);return n}function se(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function oe(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var ae=function(){function e(t){this[j]=Y();this._result=this._state=undefined;this._subscribers=[];if(x!==t){typeof t!=="function"&&se();this instanceof e?$(this,t):oe()}}e.prototype.catch=function t(e){return this.then(null,e)};e.prototype.finally=function n(e){var t=this;var n=t.constructor;return t.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})})};return e}();ae.prototype.then=T;ae.all=ne;ae.race=re;ae.resolve=N;ae.reject=ie;ae._setScheduler=l;ae._setAsap=h;ae._asap=f;function ue(){var e=void 0;if(typeof t!=="undefined"){e=t}else if(typeof self!=="undefined"){e=self}else{try{e=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment")}}var r=e.Promise;if(r){var i=null;try{i=Object.prototype.toString.call(r.resolve())}catch(n){}if(i==="[object Promise]"&&!r.cast){return}}e.Promise=ae}ae.polyfill=ue;ae.Promise=ae;return ae})}).call(t,n(7))},function(e,t){},function(e,t,n){"use strict";(function(t){var r=n(0);var i={};var s=["getItem","setItem","removeItem","clear"];var o=t.localStorage;try{var a="__storejs__";o.setItem(a,a);if(o.getItem(a)!=a){throw new Error}o.removeItem(a)}catch(u){o=n(32)}r(s).each(function(e){i[e]=function(){return o[e].apply(o,arguments)}});i.async=false;e.exports=i}).call(t,n(7))},function(e,t,n){(function(t){var n={};var r={};n.length=0;n.getItem=function(e){if(e in r){return r[e]}return null};n.setItem=function(e,t){if(typeof t==="undefined"){n.removeItem(e)}else{if(!r.hasOwnProperty(e)){n.length++}r[e]=""+t}};n.removeItem=function(e){if(r.hasOwnProperty(e)){delete r[e];n.length--}};n.key=function(e){return Object.keys(r)[e]||null};n.clear=function(){r={};n.length=0};if(true){e.exports=n}else{t.localStorageMemory=n}})(this)},function(e,t,n){"use strict";var r=n(5);var i=n(34);var s=n(3),o=s.isNullOrUndefined;var a=n(0),u=a.extend,c=a.isObject;var f=function p(e){return{push:e,stats:e,engine:e,api:e}};function l(e){var t=void 0;var n=e.slice(0,8).toLowerCase();switch(e.slice(-9)){case"-9Nh9j0Va":t="lncldapi.com";break;case"-MdYXbMMI":t="lncldglobal.com";break;default:t="lncld.net"}return{push:"https://"+n+".push."+t,stats:"https://"+n+".stats."+t,engine:"https://"+n+".engine."+t,api:"https://"+n+".api."+t}}var h=false;r.init=function v(e){if(!c(e)){return r.init({appId:e,appKey:arguments.length<=1?undefined:arguments[1],masterKey:arguments.length<=2?undefined:arguments[2]})}var t=e.appId,n=e.appKey,s=e.masterKey,o=e.hookKey,a=e.serverURLs,d=e.disableCurrentUser,p=e.production,v=e.realtime;if(r.applicationId)throw new Error("SDK is already initialized.");if(!t)throw new TypeError("appId must be a string");if(!n)throw new TypeError("appKey must be a string");if("Browser"&&s)console.warn("MasterKey is not supposed to be used in browser.");r._config.applicationId=t;r._config.applicationKey=n;r._config.masterKey=s;if(false)r._config.hookKey=o||process.env.LEANCLOUD_APP_HOOK_KEY;if(typeof p!=="undefined")r._config.production=p;if(typeof d!=="undefined")r._config.disableCurrentUser=d;r._appRouter=new i(r);var _=h||typeof a!=="undefined";r._setServerURLs(u({},l(t),r._config.serverURLs,typeof a==="string"?f(a):a),_);if(v){r._config.realtime=v}else if(r._sharedConfig.liveQueryRealtime){r._config.realtime=new r._sharedConfig.liveQueryRealtime({appId:t,appKey:n})}};if(false){r.Cloud=r.Cloud||{};r.Cloud.useMasterKey=function(){r._config.useMasterKey=true}}r.setProduction=function(e){if(!o(e)){r._config.production=e?1:0}else{r._config.production=null}};r._setServerURLs=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof e!=="string"){u(r._config.serverURLs,e)}else{r._config.serverURLs=f(e)}if(t){if(r._appRouter){r._appRouter.disable()}else{h=true}}};r.setServerURLs=function(e){return r._setServerURLs(e)};r.keepErrorRawMessage=function(e){r._sharedConfig.keepErrorRawMessage=e};r.setRequestTimeout=function(e){r._config.requestTimeout=e};r.initialize=r.init;var d=function _(e){return Object.defineProperty(r,e,{get:function t(){return r._config[e]},set:function n(t){r._config[e]=t}})};["applicationId","applicationKey","masterKey","hookKey"].forEach(d)},function(e,t,n){"use strict";var r=n(3),i=r.ajax;var s=n(13);function o(e){var t=this;this.AV=e;this.lockedUntil=0;s.getAsync("serverURLs").then(function(e){if(t.disabled)return;if(!e)return t.lock(0);var n=e.serverURLs,r=e.lockedUntil;t.AV._setServerURLs(n,false);t.lockedUntil=r}).catch(function(){return t.lock(0)})}o.prototype.disable=function a(){this.disabled=true};o.prototype.lock=function u(e){this.lockedUntil=Date.now()+e};o.prototype.refresh=function c(){var e=this;if(this.disabled)return;if(Date.now()<this.lockedUntil)return;this.lock(10);var t="https://app-router.leancloud.cn/2/route";return i({method:"get",url:t,query:{appId:this.AV.applicationId}}).then(function(t){if(e.disabled)return;var n=t.ttl;if(!n)throw new Error("missing ttl");n=n*1e3;var r="https://";var i={push:r+t.push_server,stats:r+t.stats_server,engine:r+t.engine_server,api:r+t.api_server};e.AV._setServerURLs(i,false);e.lock(n);return s.setAsync("serverURLs",{serverURLs:i,lockedUntil:e.lockedUntil},n)}).catch(function(t){console.warn("refresh server URLs failed: "+t.message);e.lock(600)})};e.exports=o},function(e,t,n){"use strict";var r=n(0);e.exports=function(e){var t=/\s+/;var n=Array.prototype.slice;e.Events={on:function i(e,n,r){var i,s,o,a,u;if(!n){return this}e=e.split(t);i=this._callbacks||(this._callbacks={});s=e.shift();while(s){u=i[s];o=u?u.tail:{};o.next=a={};o.context=r;o.callback=n;i[s]={tail:a,next:u?u.next:o};s=e.shift()}return this},off:function s(e,n,i){var s,o,a,u,c,f;if(!(o=this._callbacks)){return}if(!(e||n||i)){delete this._callbacks;return this}e=e?e.split(t):r.keys(o);s=e.shift();while(s){a=o[s];delete o[s];if(!a||!(n||i)){continue}u=a.tail;a=a.next;while(a!==u){c=a.callback;f=a.context;if(n&&c!==n||i&&f!==i){this.on(s,c,f)}a=a.next}s=e.shift()}return this},trigger:function o(e){var r,i,s,o,a,u,c;if(!(s=this._callbacks)){return this}u=s.all;e=e.split(t);c=n.call(arguments,1);r=e.shift();while(r){i=s[r];if(i){o=i.tail;while((i=i.next)!==o){i.callback.apply(i.context||this,c)}}i=u;if(i){o=i.tail;a=[r].concat(c);while((i=i.next)!==o){i.callback.apply(i.context||this,a)}}r=e.shift()}return this}};e.Events.bind=e.Events.on;e.Events.unbind=e.Events.off}},function(e,t,n){"use strict";var r=n(0);var i=n(1);e.exports=function(e){e.GeoPoint=function(t,n){if(r.isArray(t)){e.GeoPoint._validate(t[0],t[1]);this.latitude=t[0];this.longitude=t[1]}else if(r.isObject(t)){e.GeoPoint._validate(t.latitude,t.longitude);this.latitude=t.latitude;this.longitude=t.longitude}else if(r.isNumber(t)&&r.isNumber(n)){e.GeoPoint._validate(t,n);this.latitude=t;this.longitude=n}else{this.latitude=0;this.longitude=0}var i=this;if(this.__defineGetter__&&this.__defineSetter__){this._latitude=this.latitude;this._longitude=this.longitude;this.__defineGetter__("latitude",function(){return i._latitude});this.__defineGetter__("longitude",function(){return i._longitude});this.__defineSetter__("latitude",function(t){e.GeoPoint._validate(t,i.longitude);i._latitude=t});this.__defineSetter__("longitude",function(t){e.GeoPoint._validate(i.latitude,t);i._longitude=t})}};e.GeoPoint._validate=function(e,t){if(e<-90){throw new Error("AV.GeoPoint latitude "+e+" < -90.0.")}if(e>90){throw new Error("AV.GeoPoint latitude "+e+" > 90.0.")}if(t<-180){throw new Error("AV.GeoPoint longitude "+t+" < -180.0.")}if(t>180){throw new Error("AV.GeoPoint longitude "+t+" > 180.0.")}};e.GeoPoint.current=function(){return new i(function(t,n){navigator.geolocation.getCurrentPosition(function(n){t(new e.GeoPoint({latitude:n.coords.latitude,longitude:n.coords.longitude}))},n)})};r.extend(e.GeoPoint.prototype,{toJSON:function t(){e.GeoPoint._validate(this.latitude,this.longitude);return{__type:"GeoPoint",latitude:this.latitude,longitude:this.longitude}},radiansTo:function n(e){var t=Math.PI/180;var n=this.latitude*t;var r=this.longitude*t;var i=e.latitude*t;var s=e.longitude*t;var o=n-i;var a=r-s;var u=Math.sin(o/2);var c=Math.sin(a/2);var f=u*u+Math.cos(n)*Math.cos(i)*c*c;f=Math.min(1,f);return 2*Math.asin(Math.sqrt(f))},kilometersTo:function s(e){return this.radiansTo(e)*6371},milesTo:function o(e){return this.radiansTo(e)*3958.8}})}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e){var t="*";e.ACL=function(t){var n=this;n.permissionsById={};if(r.isObject(t)){if(t instanceof e.User){n.setReadAccess(t,true);n.setWriteAccess(t,true)}else{if(r.isFunction(t)){throw new Error("AV.ACL() called with a function.  Did you forget ()?")}e._objectEach(t,function(t,i){if(!r.isString(i)){throw new Error("Tried to create an ACL with an invalid userId.")}n.permissionsById[i]={};e._objectEach(t,function(e,t){if(t!=="read"&&t!=="write"){throw new Error("Tried to create an ACL with an invalid permission type.")}if(!r.isBoolean(e)){throw new Error("Tried to create an ACL with an invalid permission value.")}n.permissionsById[i][t]=e})})}}};e.ACL.prototype.toJSON=function(){return r.clone(this.permissionsById)};e.ACL.prototype._setAccess=function(t,n,i){if(n instanceof e.User){n=n.id}else if(n instanceof e.Role){n="role:"+n.getName()}if(!r.isString(n)){throw new Error("userId must be a string.")}if(!r.isBoolean(i)){throw new Error("allowed must be either true or false.")}var s=this.permissionsById[n];if(!s){if(!i){return}else{s={};this.permissionsById[n]=s}}if(i){this.permissionsById[n][t]=true}else{delete s[t];if(r.isEmpty(s)){delete this.permissionsById[n]}}};e.ACL.prototype._getAccess=function(t,n){if(n instanceof e.User){n=n.id}else if(n instanceof e.Role){n="role:"+n.getName()}var r=this.permissionsById[n];if(!r){return false}return r[t]?true:false};e.ACL.prototype.setReadAccess=function(e,t){this._setAccess("read",e,t)};e.ACL.prototype.getReadAccess=function(e){return this._getAccess("read",e)};e.ACL.prototype.setWriteAccess=function(e,t){this._setAccess("write",e,t)};e.ACL.prototype.getWriteAccess=function(e){return this._getAccess("write",e)};e.ACL.prototype.setPublicReadAccess=function(e){this.setReadAccess(t,e)};e.ACL.prototype.getPublicReadAccess=function(){return this.getReadAccess(t)};e.ACL.prototype.setPublicWriteAccess=function(e){this.setWriteAccess(t,e)};e.ACL.prototype.getPublicWriteAccess=function(){return this.getWriteAccess(t)};e.ACL.prototype.getRoleReadAccess=function(t){if(t instanceof e.Role){t=t.getName()}if(r.isString(t)){return this.getReadAccess("role:"+t)}throw new Error("role must be a AV.Role or a String")};e.ACL.prototype.getRoleWriteAccess=function(t){if(t instanceof e.Role){t=t.getName()}if(r.isString(t)){return this.getWriteAccess("role:"+t)}throw new Error("role must be a AV.Role or a String")};e.ACL.prototype.setRoleReadAccess=function(t,n){if(t instanceof e.Role){t=t.getName()}if(r.isString(t)){this.setReadAccess("role:"+t,n);return}throw new Error("role must be a AV.Role or a String")};e.ACL.prototype.setRoleWriteAccess=function(t,n){if(t instanceof e.Role){t=t.getName()}if(r.isString(t)){this.setWriteAccess("role:"+t,n);return}throw new Error("role must be a AV.Role or a String")}}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e){e.Op=function(){this._initialize.apply(this,arguments)};r.extend(e.Op.prototype,{_initialize:function t(){}});r.extend(e.Op,{_extend:e._extend,_opDecoderMap:{},_registerDecoder:function n(t,r){e.Op._opDecoderMap[t]=r},_decode:function i(t){var n=e.Op._opDecoderMap[t.__op];if(n){return n(t)}else{return undefined}}});e.Op._registerDecoder("Batch",function(t){var n=null;e._arrayEach(t.ops,function(t){t=e.Op._decode(t);n=t._mergeWithPrevious(n)});return n});e.Op.Set=e.Op._extend({_initialize:function s(e){this._value=e},value:function o(){return this._value},toJSON:function a(){return e._encode(this.value())},_mergeWithPrevious:function u(e){return this},_estimate:function c(e){return this.value()}});e.Op._UNSET={};e.Op.Unset=e.Op._extend({toJSON:function f(){return{__op:"Delete"}},_mergeWithPrevious:function l(e){return this},_estimate:function h(t){return e.Op._UNSET}});e.Op._registerDecoder("Delete",function(t){return new e.Op.Unset});e.Op.Increment=e.Op._extend({_initialize:function d(e){this._amount=e},amount:function p(){return this._amount},toJSON:function v(){return{__op:"Increment",amount:this._amount}},_mergeWithPrevious:function _(t){if(!t){return this}else if(t instanceof e.Op.Unset){return new e.Op.Set(this.amount())}else if(t instanceof e.Op.Set){return new e.Op.Set(t.value()+this.amount())}else if(t instanceof e.Op.Increment){return new e.Op.Increment(this.amount()+t.amount())}else{throw new Error("Op is invalid after previous op.")}},_estimate:function y(e){if(!e){return this.amount()}return e+this.amount()}});e.Op._registerDecoder("Increment",function(t){return new e.Op.Increment(t.amount)});e.Op.BitAnd=e.Op._extend({_initialize:function m(e){this._value=e},value:function g(){return this._value},toJSON:function b(){return{__op:"BitAnd",value:this.value()}},_mergeWithPrevious:function w(t){if(!t){return this}else if(t instanceof e.Op.Unset){return new e.Op.Set(0)}else if(t instanceof e.Op.Set){return new e.Op.Set(t.value()&this.value())}else{throw new Error("Op is invalid after previous op.")}},_estimate:function O(e){return e&this.value()}});e.Op._registerDecoder("BitAnd",function(t){return new e.Op.BitAnd(t.value)});e.Op.BitOr=e.Op._extend({_initialize:function A(e){this._value=e},value:function S(){return this._value},toJSON:function C(){return{__op:"BitOr",value:this.value()}},_mergeWithPrevious:function E(t){if(!t){return this}else if(t instanceof e.Op.Unset){return new e.Op.Set(this.value())}else if(t instanceof e.Op.Set){return new e.Op.Set(t.value()|this.value())}else{throw new Error("Op is invalid after previous op.")}},_estimate:function T(e){return e|this.value()}});e.Op._registerDecoder("BitOr",function(t){return new e.Op.BitOr(t.value)});e.Op.BitXor=e.Op._extend({_initialize:function N(e){this._value=e},value:function j(){return this._value},toJSON:function x(){return{__op:"BitXor",value:this.value()}},_mergeWithPrevious:function U(t){if(!t){return this}else if(t instanceof e.Op.Unset){return new e.Op.Set(this.value())}else if(t instanceof e.Op.Set){return new e.Op.Set(t.value()^this.value())}else{throw new Error("Op is invalid after previous op.")}},_estimate:function k(e){return e^this.value()}});e.Op._registerDecoder("BitXor",function(t){return new e.Op.BitXor(t.value)});e.Op.Add=e.Op._extend({_initialize:function I(e){this._objects=e},objects:function R(){return this._objects},toJSON:function D(){return{__op:"Add",objects:e._encode(this.objects())}},_mergeWithPrevious:function P(t){if(!t){return this}else if(t instanceof e.Op.Unset){return new e.Op.Set(this.objects())}else if(t instanceof e.Op.Set){return new e.Op.Set(this._estimate(t.value()))}else if(t instanceof e.Op.Add){return new e.Op.Add(t.objects().concat(this.objects()))}else{throw new Error("Op is invalid after previous op.")}},_estimate:function L(e){if(!e){return r.clone(this.objects())}else{return e.concat(this.objects())}}});e.Op._registerDecoder("Add",function(t){return new e.Op.Add(e._decode(t.objects))});e.Op.AddUnique=e.Op._extend({_initialize:function F(e){this._objects=r.uniq(e)},objects:function q(){return this._objects},toJSON:function M(){return{__op:"AddUnique",objects:e._encode(this.objects())}},_mergeWithPrevious:function W(t){if(!t){return this}else if(t instanceof e.Op.Unset){return new e.Op.Set(this.objects())}else if(t instanceof e.Op.Set){return new e.Op.Set(this._estimate(t.value()))}else if(t instanceof e.Op.AddUnique){return new e.Op.AddUnique(this._estimate(t.objects()))}else{throw new Error("Op is invalid after previous op.")}},_estimate:function B(t){if(!t){return r.clone(this.objects())}else{var n=r.clone(t);e._arrayEach(this.objects(),function(t){if(t instanceof e.Object&&t.id){var i=r.find(n,function(n){return n instanceof e.Object&&n.id===t.id});if(!i){n.push(t)}else{var s=r.indexOf(n,i);n[s]=t}}else if(!r.contains(n,t)){n.push(t)}});return n}}});e.Op._registerDecoder("AddUnique",function(t){return new e.Op.AddUnique(e._decode(t.objects))});e.Op.Remove=e.Op._extend({_initialize:function J(e){this._objects=r.uniq(e)},objects:function Q(){return this._objects},toJSON:function V(){return{__op:"Remove",objects:e._encode(this.objects())}},_mergeWithPrevious:function K(t){if(!t){return this}else if(t instanceof e.Op.Unset){return t}else if(t instanceof e.Op.Set){return new e.Op.Set(this._estimate(t.value()))}else if(t instanceof e.Op.Remove){return new e.Op.Remove(r.union(t.objects(),this.objects()))}else{throw new Error("Op is invalid after previous op.")}},_estimate:function z(t){if(!t){return[]}else{var n=r.difference(t,this.objects());e._arrayEach(this.objects(),function(t){if(t instanceof e.Object&&t.id){n=r.reject(n,function(n){return n instanceof e.Object&&n.id===t.id})}});return n}}});e.Op._registerDecoder("Remove",function(t){return new e.Op.Remove(e._decode(t.objects))});e.Op.Relation=e.Op._extend({_initialize:function G(t,n){this._targetClassName=null;var i=this;var s=function o(t){if(t instanceof e.Object){if(!t.id){throw new Error("You can't add an unsaved AV.Object to a relation.")}if(!i._targetClassName){i._targetClassName=t.className}if(i._targetClassName!==t.className){throw new Error("Tried to create a AV.Relation with 2 different types: "+i._targetClassName+" and "+t.className+".")}return t.id}return t};this.relationsToAdd=r.uniq(r.map(t,s));this.relationsToRemove=r.uniq(r.map(n,s))},added:function H(){var t=this;return r.map(this.relationsToAdd,function(n){var r=e.Object._create(t._targetClassName);r.id=n;return r})},removed:function $(){var t=this;return r.map(this.relationsToRemove,function(n){var r=e.Object._create(t._targetClassName);r.id=n;return r})},toJSON:function X(){var e=null;var t=null;var n=this;var i=function o(e){return{__type:"Pointer",className:n._targetClassName,objectId:e}};var s=null;if(this.relationsToAdd.length>0){s=r.map(this.relationsToAdd,i);e={__op:"AddRelation",objects:s}}if(this.relationsToRemove.length>0){s=r.map(this.relationsToRemove,i);t={__op:"RemoveRelation",objects:s}}if(e&&t){return{__op:"Batch",ops:[e,t]}}return e||t||{}},_mergeWithPrevious:function Y(t){if(!t){return this}else if(t instanceof e.Op.Unset){throw new Error("You can't modify a relation after deleting it.")}else if(t instanceof e.Op.Relation){if(t._targetClassName&&t._targetClassName!==this._targetClassName){throw new Error("Related object must be of class "+t._targetClassName+", but "+this._targetClassName+" was passed in.")}var n=r.union(r.difference(t.relationsToAdd,this.relationsToRemove),this.relationsToAdd);var i=r.union(r.difference(t.relationsToRemove,this.relationsToAdd),this.relationsToRemove);var s=new e.Op.Relation(n,i);s._targetClassName=this._targetClassName;return s}else{throw new Error("Op is invalid after previous op.")}},_estimate:function Z(t,n,r){if(!t){var i=new e.Relation(n,r);i.targetClassName=this._targetClassName}else if(t instanceof e.Relation){if(this._targetClassName){if(t.targetClassName){if(t.targetClassName!==this._targetClassName){throw new Error("Related object must be a "+t.targetClassName+", but a "+this._targetClassName+" was passed in.")}}else{t.targetClassName=this._targetClassName}}return t}else{throw new Error("Op is invalid after previous op.")}}});e.Op._registerDecoder("AddRelation",function(t){return new e.Op.Relation(e._decode(t.objects),[])});e.Op._registerDecoder("RemoveRelation",function(t){return new e.Op.Relation([],e._decode(t.objects))})}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e){e.Relation=function(e,t){if(!r.isString(t)){throw new TypeError("key must be a string")}this.parent=e;this.key=t;this.targetClassName=null};e.Relation.reverseQuery=function(t,n,r){var i=new e.Query(t);i.equalTo(n,r._toPointer());return i};r.extend(e.Relation.prototype,{_ensureParentAndKey:function t(e,n){this.parent=this.parent||e;this.key=this.key||n;if(this.parent!==e){throw new Error("Internal Error. Relation retrieved from two different Objects.")}if(this.key!==n){throw new Error("Internal Error. Relation retrieved from two different keys.")}},add:function n(t){if(!r.isArray(t)){t=[t]}var n=new e.Op.Relation(t,[]);this.parent.set(this.key,n);this.targetClassName=n._targetClassName},remove:function i(t){if(!r.isArray(t)){t=[t]}var n=new e.Op.Relation([],t);this.parent.set(this.key,n);this.targetClassName=n._targetClassName},toJSON:function s(){return{__type:"Relation",className:this.targetClassName}},query:function o(){var t;var o;if(!this.targetClassName){t=e.Object._getSubclass(this.parent.className);o=new e.Query(t);o._extraOptions.redirectClassNameForKey=this.key}else{t=e.Object._getSubclass(this.targetClassName);o=new e.Query(t)}o._addCondition("$relatedTo","object",this.parent._toPointer());o._addCondition("$relatedTo","key",this.key);return o}})}},function(e,t,n){"use strict";var r=n(0);var i=n(41);var s=n(42);var o=n(43);var a=n(4);var u=n(2)._request;var c=n(1);var f=n(3),l=f.tap,h=f.transformFetchOptions;var d=n(6)("leancloud:file");var p=n(47);e.exports=function(e){var t=function _(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};var n=function y(e){if(!r.isString(e))return"";return e.match(/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/)[4]};var f=function m(e){if(e<26){return String.fromCharCode(65+e)}if(e<52){return String.fromCharCode(97+(e-26))}if(e<62){return String.fromCharCode(48+(e-52))}if(e===62){return"+"}if(e===63){return"/"}throw new Error("Tried to encode large digit "+e+" in base64.")};var v=function g(e){var t=[];t.length=Math.ceil(e.length/3);r.times(t.length,function(n){var r=e[n*3];var i=e[n*3+1]||0;var s=e[n*3+2]||0;var o=n*3+1<e.length;var a=n*3+2<e.length;t[n]=[f(r>>2&63),f(r<<4&48|i>>4&15),o?f(i<<2&60|s>>6&3):"=",a?f(s&63):"="].join("")});return t.join("")};e.File=function(t,i,s){this.attributes={name:t,url:"",metaData:{},base64:""};if(r.isString(i)){throw new TypeError("Creating an AV.File from a String is not yet supported.")}if(r.isArray(i)){this.attributes.metaData.size=i.length;i={base64:v(i)}}this._extName="";this._data=i;this._uploadHeaders={};if(false){if(i&&i.blob){this._extName=n(i.blob.uri)}}if(typeof Blob!=="undefined"&&i instanceof Blob){if(i.size){this.attributes.metaData.size=i.size}if(i.name){this._extName=n(i.name)}}var o=void 0;if(i&&i.owner){o=i.owner}else if(!e._config.disableCurrentUser){try{o=e.User.current()}catch(a){if("SYNC_API_NOT_AVAILABLE"!==a.code){throw a}}}this.attributes.metaData.owner=o?o.id:"unknown";this.set("mime_type",s)};e.File.withURL=function(t,n,r,i){if(!t||!n){throw new Error("Please provide file name and url")}var s=new e.File(t,null,i);if(r){for(var o in r){if(!s.attributes.metaData[o])s.attributes.metaData[o]=r[o]}}s.attributes.url=n;s.attributes.metaData.__source="external";return s};e.File.createWithoutData=function(t){var n=new e.File;n.id=t;return n};r.extend(e.File.prototype,{className:"_File",_toFullJSON:function b(t){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var s=r.clone(this.attributes);e._objectEach(s,function(n,r){s[r]=e._encode(n,t,undefined,i)});e._objectEach(this._operations,function(e,t){s[t]=e});if(r.has(this,"id")){s.objectId=this.id}r(["createdAt","updatedAt"]).each(function(e){if(r.has(n,e)){var t=n[e];s[e]=r.isDate(t)?t.toJSON():t}});if(i){s.__type="File"}return s},toFullJSON:function w(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return this._toFullJSON(e)},toJSON:function O(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[this];return this._toFullJSON(n,false)},_toPointer:function A(){return{__type:"Pointer",className:this.className,objectId:this.id}},getACL:function S(){return this._acl},setACL:function C(t){if(!(t instanceof e.ACL)){return new a(a.OTHER_CAUSE,"ACL must be a AV.ACL.")}this._acl=t;return this},name:function E(){return this.get("name")},url:function T(){return this.get("url")},get:function N(e){switch(e){case"objectId":return this.id;case"url":case"name":case"mime_type":case"metaData":case"createdAt":case"updatedAt":return this.attributes[e];default:return this.attributes.metaData[e]}},set:function j(){var e=this;var j=function s(t,n){switch(t){case"name":case"url":case"mime_type":case"base64":case"metaData":e.attributes[t]=n;break;default:e.attributes.metaData[t]=n;break}};for(var t=arguments.length,n=Array(t),r=0;r<t;r++){n[r]=arguments[r]}switch(n.length){case 1:for(var i in n[0]){j(i,n[0][i])}break;case 2:j(n[0],n[1]);break}return this},setUploadHeader:function x(e,t){this._uploadHeaders[e]=t;return this},metaData:function U(e,t){if(e&&t){this.attributes.metaData[e]=t;return this}else if(e&&!t){return this.attributes.metaData[e]}else{return this.attributes.metaData}},thumbnailURL:function k(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:100;var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:"png";var s=this.attributes.url;if(!s){throw new Error("Invalid url.")}if(!e||!t||e<=0||t<=0){throw new Error("Invalid width or height value.")}if(n<=0||n>100){throw new Error("Invalid quality value.")}var o=r?2:1;return s+"?imageView/"+o+"/w/"+e+"/h/"+t+"/q/"+n+"/format/"+i},size:function I(){return this.metaData().size},ownerId:function R(){return this.metaData().owner},destroy:function D(e){if(!this.id){return c.reject(new Error("The file id does not eixst."))}var t=u("files",null,this.id,"DELETE",null,e);return t},_fileToken:function P(e,r){var i=this.attributes.name;var s=n(i);if(!s&&this._extName){i+=this._extName;s=this._extName}var o=t()+t()+t()+t()+t()+s;var a={key:o,name:i,keep_file_name:r.keepFileName,ACL:this._acl,mime_type:e,metaData:this.attributes.metaData};this._qiniu_key=o;return u("fileTokens",null,null,"POST",a,r)},save:function L(){var e=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(this.id){throw new Error("File is already saved.")}if(!this._previousSave){if(this._data){var n=this.get("mime_type");this._previousSave=this._fileToken(n,t).then(function(a){if(a.mime_type){n=a.mime_type;e.set("mime_type",n)}e._token=a.token;return c.resolve().then(function(){var t=e._data;if(t&&t.base64){return p(t.base64,n)}if(t&&t.blob){if(!t.blob.type&&n){t.blob.type=n}if(!t.blob.name){t.blob.name=e.get("name")}return t.blob}if(typeof Blob!=="undefined"&&t instanceof Blob){return t}throw new TypeError("malformed file data")}).then(function(n){var u=r.extend({},t);if(t.onprogress){u.onprogress=function(e){if(e.direction==="download")return;return t.onprogress(e)}}switch(a.provider){case"s3":return o(a,n,e,u);case"qcloud":return i(a,n,e,u);case"qiniu":default:return s(a,n,e,u)}}).then(l(function(){return e._callback(true)}),function(t){e._callback(false);throw t})})}else if(this.attributes.url&&this.attributes.metaData.__source==="external"){var a={name:this.attributes.name,ACL:this._acl,metaData:this.attributes.metaData,mime_type:this.mimeType,url:this.attributes.url};this._previousSave=u("files",this.attributes.name,null,"post",a,t).then(function(t){e.attributes.name=t.name;e.attributes.url=t.url;e.id=t.objectId;if(t.size){e.attributes.metaData.size=t.size}return e})}}return this._previousSave},_callback:function F(e){u("fileCallback",null,null,"post",{token:this._token,result:e}).catch(d);delete this._token;delete this._data},fetch:function q(e,t){var n=u("files",null,this.id,"GET",h(e),t);return n.then(this._finishFetch.bind(this))},_finishFetch:function M(t){var n=e.Object.prototype.parse(t);n.attributes={name:n.name,url:n.url,mime_type:n.mime_type,bucket:n.bucket};n.attributes.metaData=n.metaData||{};n.id=n.objectId;delete n.objectId;delete n.metaData;delete n.url;delete n.name;delete n.mime_type;delete n.bucket;r.extend(this,n);return this}})}},function(e,t,n){"use strict";var r=n(8);var i=n(6)("cos");var s=n(1);e.exports=function o(e,t,n){var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};n.attributes.url=e.url;n._bucket=e.bucket;n.id=e.objectId;var a=e.upload_url+"?sign="+encodeURIComponent(e.token);return new s(function(e,s){var u=r("POST",a).set(n._uploadHeaders).attach("fileContent",t,n.attributes.name).field("op","upload");if(o.onprogress){u.on("progress",o.onprogress)}u.end(function(t,r){if(r){i(r.status,r.body,r.text)}if(t){if(r){t.statusCode=r.status;t.responseText=r.text;t.response=r.body}return s(t)}e(n)})})}},function(e,t,n){"use strict";var r=n(8);var i=n(1);var s=n(6)("qiniu");e.exports=function o(e,t,n){var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};n.attributes.url=e.url;n._bucket=e.bucket;n.id=e.objectId;var a=e.token;var u=e.upload_url||"https://upload.qiniup.com";return new i(function(i,c){var f=r("POST",u).set(n._uploadHeaders).attach("file",t,n.attributes.name).field("name",n.attributes.name).field("key",e.key||n._qiniu_key).field("token",a);if(o.onprogress){f.on("progress",o.onprogress)}f.end(function(e,t){if(t){s(t.status,t.body,t.text)}if(e){if(t){e.statusCode=t.status;e.responseText=t.text;e.response=t.body}return c(e)}i(n)})})}},function(e,t,n){"use strict";var r=n(8);var i=n(1);var s=function o(e,t){if(t){e.statusCode=t.status;e.responseText=t.text;e.response=t.body}return e};e.exports=function a(e,t,n){var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};n.attributes.url=e.url;n._bucket=e.bucket;n.id=e.objectId;return new i(function(i,a){var u=r("PUT",e.upload_url).set(Object.assign({"Content-Type":n.get("mime_type"),"Cache-Control":"public, max-age=31536000"},n._uploadHeaders));if(o.onprogress){u.on("progress",o.onprogress)}u.on("response",function(e){if(e.ok)return i(n);a(s(e.error,e))});u.on("error",function(e,t){return a(s(e,t))});u.send(t).end()})}},function(e,t,n){(function(){var t=n(45),r=n(14).utf8,i=n(46),s=n(14).bin,o=function(e,n){if(e.constructor==String)if(n&&n.encoding==="binary")e=s.stringToBytes(e);else e=r.stringToBytes(e);else if(i(e))e=Array.prototype.slice.call(e,0);else if(!Array.isArray(e))e=e.toString();var a=t.bytesToWords(e),u=e.length*8,c=1732584193,f=-271733879,l=-1732584194,h=271733878;for(var d=0;d<a.length;d++){a[d]=(a[d]<<8|a[d]>>>24)&16711935|(a[d]<<24|a[d]>>>8)&4278255360}a[u>>>5]|=128<<u%32;a[(u+64>>>9<<4)+14]=u;var p=o._ff,v=o._gg,_=o._hh,y=o._ii;for(var d=0;d<a.length;d+=16){var m=c,g=f,b=l,w=h;c=p(c,f,l,h,a[d+0],7,-680876936);h=p(h,c,f,l,a[d+1],12,-389564586);l=p(l,h,c,f,a[d+2],17,606105819);f=p(f,l,h,c,a[d+3],22,-1044525330);c=p(c,f,l,h,a[d+4],7,-176418897);h=p(h,c,f,l,a[d+5],12,1200080426);l=p(l,h,c,f,a[d+6],17,-1473231341);f=p(f,l,h,c,a[d+7],22,-45705983);c=p(c,f,l,h,a[d+8],7,1770035416);h=p(h,c,f,l,a[d+9],12,-1958414417);l=p(l,h,c,f,a[d+10],17,-42063);f=p(f,l,h,c,a[d+11],22,-1990404162);c=p(c,f,l,h,a[d+12],7,1804603682);h=p(h,c,f,l,a[d+13],12,-40341101);l=p(l,h,c,f,a[d+14],17,-1502002290);f=p(f,l,h,c,a[d+15],22,1236535329);c=v(c,f,l,h,a[d+1],5,-165796510);h=v(h,c,f,l,a[d+6],9,-1069501632);l=v(l,h,c,f,a[d+11],14,643717713);f=v(f,l,h,c,a[d+0],20,-373897302);c=v(c,f,l,h,a[d+5],5,-701558691);h=v(h,c,f,l,a[d+10],9,38016083);l=v(l,h,c,f,a[d+15],14,-660478335);f=v(f,l,h,c,a[d+4],20,-405537848);c=v(c,f,l,h,a[d+9],5,568446438);h=v(h,c,f,l,a[d+14],9,-1019803690);l=v(l,h,c,f,a[d+3],14,-187363961);f=v(f,l,h,c,a[d+8],20,1163531501);
c=v(c,f,l,h,a[d+13],5,-1444681467);h=v(h,c,f,l,a[d+2],9,-51403784);l=v(l,h,c,f,a[d+7],14,1735328473);f=v(f,l,h,c,a[d+12],20,-1926607734);c=_(c,f,l,h,a[d+5],4,-378558);h=_(h,c,f,l,a[d+8],11,-2022574463);l=_(l,h,c,f,a[d+11],16,1839030562);f=_(f,l,h,c,a[d+14],23,-35309556);c=_(c,f,l,h,a[d+1],4,-1530992060);h=_(h,c,f,l,a[d+4],11,1272893353);l=_(l,h,c,f,a[d+7],16,-155497632);f=_(f,l,h,c,a[d+10],23,-1094730640);c=_(c,f,l,h,a[d+13],4,681279174);h=_(h,c,f,l,a[d+0],11,-358537222);l=_(l,h,c,f,a[d+3],16,-722521979);f=_(f,l,h,c,a[d+6],23,76029189);c=_(c,f,l,h,a[d+9],4,-640364487);h=_(h,c,f,l,a[d+12],11,-421815835);l=_(l,h,c,f,a[d+15],16,530742520);f=_(f,l,h,c,a[d+2],23,-995338651);c=y(c,f,l,h,a[d+0],6,-198630844);h=y(h,c,f,l,a[d+7],10,1126891415);l=y(l,h,c,f,a[d+14],15,-1416354905);f=y(f,l,h,c,a[d+5],21,-57434055);c=y(c,f,l,h,a[d+12],6,1700485571);h=y(h,c,f,l,a[d+3],10,-1894986606);l=y(l,h,c,f,a[d+10],15,-1051523);f=y(f,l,h,c,a[d+1],21,-2054922799);c=y(c,f,l,h,a[d+8],6,1873313359);h=y(h,c,f,l,a[d+15],10,-30611744);l=y(l,h,c,f,a[d+6],15,-1560198380);f=y(f,l,h,c,a[d+13],21,1309151649);c=y(c,f,l,h,a[d+4],6,-145523070);h=y(h,c,f,l,a[d+11],10,-1120210379);l=y(l,h,c,f,a[d+2],15,718787259);f=y(f,l,h,c,a[d+9],21,-343485551);c=c+m>>>0;f=f+g>>>0;l=l+b>>>0;h=h+w>>>0}return t.endian([c,f,l,h])};o._ff=function(e,t,n,r,i,s,o){var a=e+(t&n|~t&r)+(i>>>0)+o;return(a<<s|a>>>32-s)+t};o._gg=function(e,t,n,r,i,s,o){var a=e+(t&r|n&~r)+(i>>>0)+o;return(a<<s|a>>>32-s)+t};o._hh=function(e,t,n,r,i,s,o){var a=e+(t^n^r)+(i>>>0)+o;return(a<<s|a>>>32-s)+t};o._ii=function(e,t,n,r,i,s,o){var a=e+(n^(t|~r))+(i>>>0)+o;return(a<<s|a>>>32-s)+t};o._blocksize=16;o._digestsize=16;e.exports=function(e,n){if(e===undefined||e===null)throw new Error("Illegal argument "+e);var r=t.wordsToBytes(o(e,n));return n&&n.asBytes?r:n&&n.asString?s.bytesToString(r):t.bytesToHex(r)}})()},function(e,t){(function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number){return n.rotl(e,8)&16711935|n.rotl(e,24)&4278255360}for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(Math.random()*256));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<e.length*32;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++){t.push((e[n]>>>4).toString(16));t.push((e[n]&15).toString(16))}return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],r=0;r<e.length;r+=3){var i=e[r]<<16|e[r+1]<<8|e[r+2];for(var s=0;s<4;s++)if(r*8+s*6<=e.length*8)n.push(t.charAt(i>>>6*(3-s)&63));else n.push("=")}return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<e.length;i=++r%4){if(i==0)continue;n.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<i*2|t.indexOf(e.charAt(r))>>>6-i*2)}return n}};e.exports=n})()},function(e,t){e.exports=function(e){return e!=null&&(n(e)||r(e)||!!e._isBuffer)};function n(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function r(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&n(e.slice(0,0))}},function(e,t,n){"use strict";var r=function i(e,t){var n;if(e.indexOf("base64")<0){n=atob(e)}else if(e.split(",")[0].indexOf("base64")>=0){t=t||e.split(",")[0].split(":")[1].split(";")[0];n=atob(e.split(",")[1])}else{n=unescape(e.split(",")[1])}var r=new Uint8Array(n.length);for(var i=0;i<n.length;i++){r[i]=n.charCodeAt(i)}return new Blob([r],{type:t})};e.exports=r},function(e,t,n){"use strict";var r=function(){function e(e,t){var n=[];var r=true;var i=false;var s=undefined;try{for(var o=e[Symbol.iterator](),a;!(r=(a=o.next()).done);r=true){n.push(a.value);if(t&&n.length===t)break}}catch(u){i=true;s=u}finally{try{if(!r&&o["return"])o["return"]()}finally{if(i)throw s}}return n}return function(t,n){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,n)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var i=n(0);var s=n(4);var o=n(1);var a=n(2),u=a._request;var c=n(3),f=c.isNullOrUndefined,l=c.ensureArray,h=c.transformFetchOptions,d=c.setValue,p=c.findValue,v=c.isPlainObject;var _=function w(e){if(i.isArray(e))return e.map(w);if(v(e))return i.mapObject(e,w);if(i.isObject(e)&&e._toPointer)return e._toPointer();return e};var y=["objectId","createdAt","updatedAt"];var m=function O(e){if(y.indexOf(e)!==-1){throw new Error("key["+e+"] is reserved")}};var g=function A(e){var t=i.find(e,function(e){return e instanceof Error});if(!t){return e}var n=new s(t.code,t.message);n.results=e;throw n};function b(e,t){if(!(e&&e[t])){return null}return i.isFunction(e[t])?e[t]():e[t]}e.exports=function(e){e.Object=function(t,n){if(i.isString(t)){return e.Object._create.apply(this,arguments)}t=t||{};if(n&&n.parse){t=this.parse(t);t=this._mergeMagicFields(t)}var r=b(this,"defaults");if(r){t=i.extend({},r,t)}if(n&&n.collection){this.collection=n.collection}this._serverData={};this._opSetQueue=[{}];this._flags={};this.attributes={};this._hashedJSON={};this._escapedAttributes={};this.cid=i.uniqueId("c");this.changed={};this._silent={};this._pending={};this.set(t,{silent:true});this.changed={};this._silent={};this._pending={};this._hasData=true;this._previousAttributes=i.clone(this.attributes);this.initialize.apply(this,arguments)};e.Object.saveAll=function(t,n){return e.Object._deepSaveAsync(t,null,n)};e.Object.fetchAll=function(e,t){return o.resolve().then(function(){return u("batch",null,null,"POST",{requests:i.map(e,function(e){if(!e.className)throw new Error("object must have className to fetch");if(!e.id)throw new Error("object must have id to fetch");if(e.dirty())throw new Error("object is modified but not saved");return{method:"GET",path:"/1.1/classes/"+e.className+"/"+e.id}})},t)}).then(function(t){var n=i.map(e,function(e,n){if(t[n].success){var r=e.parse(t[n].success);e._cleanupUnsetKeys(r);e._finishFetch(r);return e}if(t[n].success===null){return new s(s.OBJECT_NOT_FOUND,"Object not found.")}return new s(t[n].error.code,t[n].error.error)});return g(n)})};i.extend(e.Object.prototype,e.Events,{_fetchWhenSave:false,initialize:function t(){},fetchWhenSave:function n(e){console.warn("AV.Object#fetchWhenSave is deprecated, use AV.Object#save with options.fetchWhenSave instead.");if(!i.isBoolean(e)){throw new Error("Expect boolean value for fetchWhenSave")}this._fetchWhenSave=e},getObjectId:function a(){return this.id},getCreatedAt:function c(){return this.createdAt||this.get("createdAt")},getUpdatedAt:function v(){return this.updatedAt||this.get("updatedAt")},toJSON:function y(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];return this._toFullJSON(n,false)},toFullJSON:function w(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return this._toFullJSON(e)},_toFullJSON:function O(t){var n=this;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var s=i.clone(this.attributes);if(i.isArray(t)){var o=t.concat(this)}e._objectEach(s,function(t,n){s[n]=e._encode(t,o,undefined,r)});e._objectEach(this._operations,function(e,t){s[t]=e});if(i.has(this,"id")){s.objectId=this.id}i(["createdAt","updatedAt"]).each(function(e){if(i.has(n,e)){var t=n[e];s[e]=i.isDate(t)?t.toJSON():t}});if(r){s.__type="Object";if(i.isArray(t)&&t.length)s.__type="Pointer";s.className=this.className}return s},_refreshCache:function A(){var t=this;if(t._refreshingCache){return}t._refreshingCache=true;e._objectEach(this.attributes,function(n,r){if(n instanceof e.Object){n._refreshCache()}else if(i.isObject(n)){if(t._resetCacheForKey(r)){t.set(r,new e.Op.Set(n),{silent:true})}}});delete t._refreshingCache},dirty:function S(e){this._refreshCache();var t=i.last(this._opSetQueue);if(e){return t[e]?true:false}if(!this.id){return true}if(i.keys(t).length>0){return true}return false},_toPointer:function C(){return{__type:"Pointer",className:this.className,objectId:this.id}},get:function E(e){switch(e){case"objectId":return this.id;case"createdAt":case"updatedAt":return this[e];default:return this.attributes[e]}},relation:function T(t){var n=this.get(t);if(n){if(!(n instanceof e.Relation)){throw new Error("Called relation() on non-relation field "+t)}n._ensureParentAndKey(this,t);return n}else{return new e.Relation(this,t)}},escape:function N(e){var t=this._escapedAttributes[e];if(t){return t}var n=this.attributes[e];var r;if(f(n)){r=""}else{r=i.escape(n.toString())}this._escapedAttributes[e]=r;return r},has:function j(e){return!f(this.attributes[e])},_mergeMagicFields:function x(t){var n=this;var r=["objectId","createdAt","updatedAt"];e._arrayEach(r,function(r){if(t[r]){if(r==="objectId"){n.id=t[r]}else if((r==="createdAt"||r==="updatedAt")&&!i.isDate(t[r])){n[r]=e._parseDate(t[r])}else{n[r]=t[r]}delete t[r]}});return t},_startSave:function U(){this._opSetQueue.push({})},_cancelSave:function k(){var t=i.first(this._opSetQueue);this._opSetQueue=i.rest(this._opSetQueue);var n=i.first(this._opSetQueue);e._objectEach(t,function(e,r){var i=t[r];var s=n[r];if(i&&s){n[r]=s._mergeWithPrevious(i)}else if(i){n[r]=i}});this._saving=this._saving-1},_finishSave:function I(t){var n={};e._traverse(this.attributes,function(t){if(t instanceof e.Object&&t.id&&t._hasData){n[t.id]=t}});var r=i.first(this._opSetQueue);this._opSetQueue=i.rest(this._opSetQueue);this._applyOpSet(r,this._serverData);this._mergeMagicFields(t);var s=this;e._objectEach(t,function(t,r){s._serverData[r]=e._decode(t,r);var i=e._traverse(s._serverData[r],function(t){if(t instanceof e.Object&&n[t.id]){return n[t.id]}});if(i){s._serverData[r]=i}});this._rebuildAllEstimatedData();var o=this._opSetQueue.map(i.clone);this._refreshCache();this._opSetQueue=o;this._saving=this._saving-1},_finishFetch:function R(t,n){this._opSetQueue=[{}];this._mergeMagicFields(t);var r=this;e._objectEach(t,function(t,n){r._serverData[n]=e._decode(t,n)});this._rebuildAllEstimatedData();this._refreshCache();this._opSetQueue=[{}];this._hasData=n},_applyOpSet:function D(t,n){var i=this;e._objectEach(t,function(t,s){var o=p(n,s),a=r(o,3),u=a[0],c=a[1],f=a[2];d(n,s,t._estimate(u,i,s));if(c&&c[f]===e.Op._UNSET){delete c[f]}})},_resetCacheForKey:function P(t){var n=this.attributes[t];if(i.isObject(n)&&!(n instanceof e.Object)&&!(n instanceof e.File)){var r=JSON.stringify(_(n));if(this._hashedJSON[t]!==r){var s=!!this._hashedJSON[t];this._hashedJSON[t]=r;return s}}return false},_rebuildEstimatedDataForKey:function L(t){var n=this;delete this.attributes[t];if(this._serverData[t]){this.attributes[t]=this._serverData[t]}e._arrayEach(this._opSetQueue,function(i){var s=i[t];if(s){var o=p(n.attributes,t),a=r(o,4),u=a[0],c=a[1],f=a[2],l=a[3];d(n.attributes,t,s._estimate(u,n,t));if(c&&c[f]===e.Op._UNSET){delete c[f]}n._resetCacheForKey(l)}})},_rebuildAllEstimatedData:function F(){var t=this;var n=i.clone(this.attributes);this.attributes=i.clone(this._serverData);e._arrayEach(this._opSetQueue,function(n){t._applyOpSet(n,t.attributes);e._objectEach(n,function(e,n){t._resetCacheForKey(n)})});e._objectEach(n,function(e,n){if(t.attributes[n]!==e){t.trigger("change:"+n,t,t.attributes[n],{})}});e._objectEach(this.attributes,function(e,r){if(!i.has(n,r)){t.trigger("change:"+r,t,e,{})}})},set:function q(t,n,r){var s;if(i.isObject(t)||f(t)){s=i.mapObject(t,function(t,n){m(n);return e._decode(t,n)});r=n}else{s={};m(t);s[t]=e._decode(n,t)}r=r||{};if(!s){return this}if(s instanceof e.Object){s=s.attributes}if(r.unset){e._objectEach(s,function(t,n){s[n]=new e.Op.Unset})}var o=i.clone(s);var a=this;e._objectEach(o,function(t,n){if(t instanceof e.Op){o[n]=t._estimate(a.attributes[n],a,n);if(o[n]===e.Op._UNSET){delete o[n]}}});this._validate(s,r);r.changes={};var u=this._escapedAttributes;e._arrayEach(i.keys(s),function(t){var n=s[t];if(n instanceof e.Relation){n.parent=a}if(!(n instanceof e.Op)){n=new e.Op.Set(n)}var o=true;if(n instanceof e.Op.Set&&i.isEqual(a.attributes[t],n.value)){o=false}if(o){delete u[t];if(r.silent){a._silent[t]=true}else{r.changes[t]=true}}var c=i.last(a._opSetQueue);c[t]=n._mergeWithPrevious(c[t]);a._rebuildEstimatedDataForKey(t);if(o){a.changed[t]=a.attributes[t];if(!r.silent){a._pending[t]=true}}else{delete a.changed[t];delete a._pending[t]}});if(!r.silent){this.change(r)}return this},unset:function M(e,t){t=t||{};t.unset=true;return this.set(e,null,t)},increment:function W(t,n){if(i.isUndefined(n)||i.isNull(n)){n=1}return this.set(t,new e.Op.Increment(n))},add:function B(t,n){return this.set(t,new e.Op.Add(l(n)))},addUnique:function J(t,n){return this.set(t,new e.Op.AddUnique(l(n)))},remove:function Q(t,n){return this.set(t,new e.Op.Remove(l(n)))},bitAnd:function V(t,n){return this.set(t,new e.Op.BitAnd(n))},bitOr:function K(t,n){return this.set(t,new e.Op.BitOr(n))},bitXor:function z(t,n){return this.set(t,new e.Op.BitXor(n))},op:function G(e){return i.last(this._opSetQueue)[e]},clear:function H(e){e=e||{};e.unset=true;var t=i.extend(this.attributes,this._operations);return this.set(t,e)},revert:function $(e){var t=i.last(this._opSetQueue);var n=l(e||i.keys(t));n.forEach(function(e){delete t[e]});this._rebuildAllEstimatedData();return this},_getSaveJSON:function X(){var t=i.clone(i.first(this._opSetQueue));e._objectEach(t,function(e,n){t[n]=e.toJSON()});return t},_canBeSerialized:function Y(){return e.Object._canBeSerializedAsValue(this.attributes)},fetch:function Z(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=arguments[1];var n=this;var r=u("classes",this.className,this.id,"GET",h(e),t);return r.then(function(t){var r=n.parse(t);if(!e.keys)n._cleanupUnsetKeys(r);n._finishFetch(r,true);return n})},_cleanupUnsetKeys:function ee(t){var n=this;e._objectEach(this._serverData,function(e,r){if(t[r]===undefined)delete n._serverData[r]})},save:function te(t,n,r){var s,a,c;if(i.isObject(t)||f(t)){s=t;c=n}else{s={};s[t]=n;c=r}c=i.clone(c)||{};if(c.wait){a=i.clone(this.attributes)}var l=i.clone(c)||{};if(l.wait){l.silent=true}if(s){this.set(s,l)}var h=this;var d=[];var p=[];e.Object._findUnsavedChildren(h,d,p);if(d.length+p.length>1){return e.Object._deepSaveAsync(this,h,c)}this._startSave();this._saving=(this._saving||0)+1;this._allPreviousSaves=this._allPreviousSaves||o.resolve();this._allPreviousSaves=this._allPreviousSaves.catch(function(e){}).then(function(){var e=h.id?"PUT":"POST";var t=h._getSaveJSON();var n={};if(h._fetchWhenSave||c.fetchWhenSave){n["new"]="true"}if(c._failOnNotExist){n.failOnNotExist="true"}if(c.query){var r;if(typeof c.query.toJSON==="function"){r=c.query.toJSON();if(r){n.where=r.where}}if(!n.where){var o=new Error("options.query is not an AV.Query");throw o}}i.extend(t,h._flags);var f="classes";var d=h.className;if(h.className==="_User"&&!h.id){f="users";d=null}var p=c._makeRequest||u;var v=p(f,d,h.id,e,t,c,n);v=v.then(function(e){var t=h.parse(e);if(c.wait){t=i.extend(s||{},t)}h._finishSave(t);if(c.wait){h.set(a,l)}return h},function(e){h._cancelSave();throw e});return v});return this._allPreviousSaves},destroy:function ne(e){e=e||{};var t=this;var n=function i(){t.trigger("destroy",t,t.collection,e)};if(!this.id){return n()}if(!e.wait){n()}var r=u("classes",this.className,this.id,"DELETE",this._flags,e);return r.then(function(){if(e.wait){n()}return t})},parse:function re(t){var n=i.clone(t);i(["createdAt","updatedAt"]).each(function(t){if(n[t]){n[t]=e._parseDate(n[t])}});if(n.createdAt&&!n.updatedAt){n.updatedAt=n.createdAt}return n},clone:function ie(){return new this.constructor(this.attributes)},isNew:function se(){return!this.id},change:function oe(t){t=t||{};var n=this._changing;this._changing=true;var r=this;e._objectEach(this._silent,function(e){r._pending[e]=true});var s=i.extend({},t.changes,this._silent);this._silent={};e._objectEach(s,function(e,n){r.trigger("change:"+n,r,r.get(n),t)});if(n){return this}var o=function a(e,t){if(!r._pending[t]&&!r._silent[t]){delete r.changed[t]}};while(!i.isEmpty(this._pending)){this._pending={};this.trigger("change",this,t);e._objectEach(this.changed,o);r._previousAttributes=i.clone(this.attributes)}this._changing=false;return this},hasChanged:function ae(e){if(!arguments.length){return!i.isEmpty(this.changed)}return this.changed&&i.has(this.changed,e)},changedAttributes:function ue(t){if(!t){return this.hasChanged()?i.clone(this.changed):false}var n={};var r=this._previousAttributes;e._objectEach(t,function(e,t){if(!i.isEqual(r[t],e)){n[t]=e}});return n},previous:function ce(e){if(!arguments.length||!this._previousAttributes){return null}return this._previousAttributes[e]},previousAttributes:function fe(){return i.clone(this._previousAttributes)},isValid:function le(){try{this.validate(this.attributes)}catch(e){return false}return true},validate:function he(t){if(i.has(t,"ACL")&&!(t.ACL instanceof e.ACL)){throw new s(s.OTHER_CAUSE,"ACL must be a AV.ACL.")}},_validate:function de(e,t){if(t.silent||!this.validate){return}e=i.extend({},this.attributes,e);this.validate(e)},getACL:function pe(){return this.get("ACL")},setACL:function ve(e,t){return this.set("ACL",e,t)},disableBeforeHook:function _e(){this.ignoreHook("beforeSave");this.ignoreHook("beforeUpdate");this.ignoreHook("beforeDelete")},disableAfterHook:function ye(){this.ignoreHook("afterSave");this.ignoreHook("afterUpdate");this.ignoreHook("afterDelete")},ignoreHook:function me(t){if(!i.contains(["beforeSave","afterSave","beforeUpdate","afterUpdate","beforeDelete","afterDelete"],t)){console.trace("Unsupported hookName: "+t)}if(!e.hookKey){console.trace("ignoreHook required hookKey")}if(!this._flags.__ignore_hooks){this._flags.__ignore_hooks=[]}this._flags.__ignore_hooks.push(t)}});e.Object.createWithoutData=function(t,n,r){var s=void 0;if(i.isString(t)){s=e.Object._getSubclass(t)}else if(t.prototype&&t.prototype instanceof e.Object){s=t}else{throw new Error("class must be a string or a subclass of AV.Object.")}var o=new s;o.id=n;o._hasData=r;return o};e.Object.destroyAll=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!e||e.length===0){return o.resolve()}var n=i.groupBy(e,function(e){return JSON.stringify({className:e.className,flags:e._flags})});var r={requests:i.map(n,function(e){var t=i.map(e,"id").join(",");return{method:"DELETE",path:"/1.1/classes/"+e[0].className+"/"+t,body:e[0]._flags}})};return u("batch",null,null,"POST",r,t).then(function(e){var t=i.find(e,function(e){return!e.success});if(t)throw new s(t.error.code,t.error.error);return undefined})};e.Object._getSubclass=function(t){if(!i.isString(t)){throw new Error("AV.Object._getSubclass requires a string argument.")}var n=e.Object._classMap[t];if(!n){n=e.Object.extend(t);e.Object._classMap[t]=n}return n};e.Object._create=function(t,n,r){var i=e.Object._getSubclass(t);return new i(n,r)};e.Object._classMap={};e.Object._extend=e._extend;e.Object["new"]=function(t,n){return new e.Object(t,n)};e.Object.extend=function(t,n,r){if(!i.isString(t)){if(t&&i.has(t,"className")){return e.Object.extend(t.className,t,n)}else{throw new Error("AV.Object.extend's first argument should be the className.")}}if(t==="User"){t="_User"}var s=null;if(i.has(e.Object._classMap,t)){var o=e.Object._classMap[t];if(n||r){s=o._extend(n,r)}else{return o}}else{n=n||{};n._className=t;s=this._extend(n,r)}s.extend=function(n){if(i.isString(n)||n&&i.has(n,"className")){return e.Object.extend.apply(s,arguments)}var r=[t].concat(i.toArray(arguments));return e.Object.extend.apply(s,r)};Object.defineProperty(s,"query",Object.getOwnPropertyDescriptor(e.Object,"query"));s["new"]=function(e,t){return new s(e,t)};e.Object._classMap[t]=s;return s};Object.defineProperty(e.Object.prototype,"className",{get:function ge(){var e=this._className||this.constructor._LCClassName||this.constructor.name;if(e==="User"){return"_User"}return e}});e.Object.register=function(t,n){if(!(t.prototype instanceof e.Object)){throw new Error("registered class is not a subclass of AV.Object")}var r=n||t.name;if(!r.length){throw new Error("registered class must be named")}if(n){t._LCClassName=n}e.Object._classMap[r]=t};Object.defineProperty(e.Object,"query",{get:function be(){return new e.Query(this.prototype.className)}});e.Object._findUnsavedChildren=function(t,n,r){e._traverse(t,function(t){if(t instanceof e.Object){if(t.dirty()){n.push(t)}return}if(t instanceof e.File){if(!t.id){r.push(t)}return}})};e.Object._canBeSerializedAsValue=function(t){var n=true;if(t instanceof e.Object||t instanceof e.File){n=!!t.id}else if(i.isArray(t)){e._arrayEach(t,function(t){if(!e.Object._canBeSerializedAsValue(t)){n=false}})}else if(i.isObject(t)){e._objectEach(t,function(t){if(!e.Object._canBeSerializedAsValue(t)){n=false}})}return n};e.Object._deepSaveAsync=function(t,n,r){var a=[];var c=[];e.Object._findUnsavedChildren(t,a,c);var f=o.resolve();i.each(c,function(e){f=f.then(function(){return e.save()})});var l=i.uniq(a);var h=i.uniq(l);return f.then(function(){return o._continueWhile(function(){return h.length>0},function(){var t=[];var n=[];e._arrayEach(h,function(e){if(t.length>20){n.push(e);return}if(e._canBeSerialized()){t.push(e)}else{n.push(e)}});h=n;if(t.length===0){return o.reject(new s(s.OTHER_CAUSE,"Tried to save a batch with a cycle."))}var a=o.resolve(i.map(t,function(e){return e._allPreviousSaves||o.resolve()}));var c=a.then(function(){return u("batch",null,null,"POST",{requests:i.map(t,function(e){var t=e.id?"PUT":"POST";var n=e._getSaveJSON();i.extend(n,e._flags);var r="classes";var s=e.className;var o="/"+r+"/"+s;if(e.className==="_User"&&!e.id){o="/users"}var o="/1.1"+o;if(e.id){o=o+"/"+e.id}e._startSave();return{method:t,path:o,body:n}})},r).then(function(e){var n=i.map(t,function(t,n){if(e[n].success){t._finishSave(t.parse(e[n].success));return t}t._cancelSave();return new s(e[n].error.code,e[n].error.error)});return g(n)})});e._arrayEach(t,function(e){e._allPreviousSaves=c});return c})}).then(function(){return t})}}},function(e,t,n){"use strict";var r=n(0);var i=n(4);e.exports=function(e){e.Role=e.Object.extend("_Role",{constructor:function t(n,i){if(r.isString(n)){e.Object.prototype.constructor.call(this,null,null);this.setName(n)}else{e.Object.prototype.constructor.call(this,n,i)}if(i){if(!(i instanceof e.ACL)){throw new TypeError("acl must be an instance of AV.ACL")}else{this.setACL(i)}}},getName:function n(){return this.get("name")},setName:function s(e,t){return this.set("name",e,t)},getUsers:function o(){return this.relation("users")},getRoles:function a(){return this.relation("roles")},validate:function u(t,n){if("name"in t&&t.name!==this.getName()){var s=t.name;if(this.id&&this.id!==t.objectId){return new i(i.OTHER_CAUSE,"A role's name can only be set before it has been saved.")}if(!r.isString(s)){return new i(i.OTHER_CAUSE,"A role's name must be a String.")}if(!/^[0-9a-zA-Z\-_ ]+$/.test(s)){return new i(i.OTHER_CAUSE,"A role's name can only contain alphanumeric characters, _,"+" -, and spaces.")}}if(e.Object.prototype.validate){return e.Object.prototype.validate.call(this,t,n)}return false}})}},function(e,t,n){"use strict";function r(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}var i=n(0);var s=n(9);var o=n(4);var a=n(2),u=a._request,c=a.request;var f=n(1);var l="anonymous";var h="lc_weapp";var d=function _(){if(typeof wx==="undefined"||typeof wx.login!=="function"){throw new Error("Weapp Login is only available in Weapp")}return new f(function(e,t){wx.login({success:function n(r){var i=r.code,s=r.errMsg;if(i){e(i)}else{t(new Error(s))}},fail:function r(){return t(new Error("wx.login "))}})})};var p=function y(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},n=t.preferUnionId,r=t.unionIdPlatform,i=r===undefined?"weixin":r,s=t.asMainAccount,o=s===undefined?true:s;return n?{platform:i,main_account:o,code:e}:{code:e}};var v=function m(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},r=n.unionIdPlatform,s=r===undefined?"weixin":r,a=n.asMainAccount,u=a===undefined?false:a;if(typeof t!=="string")throw new o(o.OTHER_CAUSE,"unionId is not a string");if(typeof s!=="string")throw new o(o.OTHER_CAUSE,"unionIdPlatform is not a string");return i.extend({},e,{platform:s,unionid:t,main_account:Boolean(u)})};e.exports=function(e){e.User=e.Object.extend("_User",{_isCurrentUser:false,_mergeMagicFields:function t(n){if(n.sessionToken){this._sessionToken=n.sessionToken;delete n.sessionToken}return e.User.__super__._mergeMagicFields.call(this,n)},_cleanupAuthData:function n(){if(!this.isCurrent()){return}var t=this.get("authData");if(!t){return}e._objectEach(this.get("authData"),function(e,n){if(!t[n]){delete t[n]}})},_synchronizeAllAuthData:function a(){var t=this.get("authData");if(!t){return}var n=this;e._objectEach(this.get("authData"),function(e,t){n._synchronizeAuthData(t)})},_synchronizeAuthData:function _(t){if(!this.isCurrent()){return}var n;if(i.isString(t)){n=t;t=e.User._authProviders[n]}else{n=t.getAuthType()}var r=this.get("authData");if(!r||!t){return}var s=t.restoreAuthentication(r[n]);if(!s){this.dissociateAuthData(t)}},_handleSaveResult:function y(t){if(t&&!e._config.disableCurrentUser){this._isCurrentUser=true}this._cleanupAuthData();this._synchronizeAllAuthData();delete this._serverData.password;this._rebuildEstimatedDataForKey("password");this._refreshCache();if((t||this.isCurrent())&&!e._config.disableCurrentUser){return f.resolve(e.User._saveCurrentUser(this))}else{return f.resolve()}},_linkWith:function m(t,n){var s=this;var o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},a=o.failOnNotExist,u=a===undefined?false:a;var c;if(i.isString(t)){c=t;t=e.User._authProviders[t]}else{c=t.getAuthType()}if(n){return this.save({authData:r({},c,n)},{fetchWhenSave:!!this.get("authData"),_failOnNotExist:u}).then(function(e){return e._handleSaveResult(true).then(function(){return e})})}else{return t.authenticate().then(function(e){return s._linkWith(t,e)})}},associateWithAuthData:function g(e,t){return this._linkWith(t,e)},associateWithAuthDataAndUnionId:function b(e,t,n,r){return this._linkWith(t,v(e,n,r))},associateWithWeapp:function w(e){var t=this;return d().then(function(n){return t._linkWith(h,p(n,e))})},linkWithWeapp:function O(e){console.warn("DEPRECATED: User#linkWithWeapp  User#associateWithWeapp ");return this.associateWithWeapp(e)},associateWithWeappWithUnionId:function A(e,t){var n=this;return d().then(function(r){return n._linkWith(h,v({code:r},e,t))})},dissociateAuthData:function S(e){this.unset("authData."+e);return this.save().then(function(e){return e._handleSaveResult(true).then(function(){return e})})},_unlinkFrom:function C(e){console.warn("DEPRECATED: User#_unlinkFrom  User#dissociateAuthData ");return this.dissociateAuthData(e)},_isLinked:function E(e){var t;if(i.isString(e)){t=e}else{t=e.getAuthType()}var n=this.get("authData")||{};return!!n[t]},isAnonymous:function T(){return this._isLinked(l)},logOut:function N(){this._logOutWithAll();this._isCurrentUser=false},_logOutWithAll:function j(){var t=this.get("authData");if(!t){return}var n=this;e._objectEach(this.get("authData"),function(e,t){n._logOutWith(t)})},_logOutWith:function x(t){if(!this.isCurrent()){return}if(i.isString(t)){t=e.User._authProviders[t]}if(t&&t.deauthenticate){t.deauthenticate()}},signUp:function U(e,t){var n;var r=e&&e.username||this.get("username");if(!r||r===""){n=new o(o.OTHER_CAUSE,"Cannot sign up user with an empty name.");throw n}var i=e&&e.password||this.get("password");if(!i||i===""){n=new o(o.OTHER_CAUSE,"Cannot sign up user with an empty password.");throw n}return this.save(e,t).then(function(e){if(e.isAnonymous()){e.unset("authData."+l);e._opSetQueue=[{}]}return e._handleSaveResult(true).then(function(){return e})})},signUpOrlogInWithMobilePhone:function k(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n;var r=e&&e.mobilePhoneNumber||this.get("mobilePhoneNumber");if(!r||r===""){n=new o(o.OTHER_CAUSE,"Cannot sign up or login user by mobilePhoneNumber "+"with an empty mobilePhoneNumber.");throw n}var i=e&&e.smsCode||this.get("smsCode");if(!i||i===""){n=new o(o.OTHER_CAUSE,"Cannot sign up or login user by mobilePhoneNumber  "+"with an empty smsCode.");throw n}t._makeRequest=function(e,t,n,r,i){return u("usersByMobilePhone",null,null,"POST",i)};return this.save(e,t).then(function(e){delete e.attributes.smsCode;delete e._serverData.smsCode;return e._handleSaveResult(true).then(function(){return e})})},loginWithAuthData:function I(e,t,n){return this._linkWith(t,e,n)},loginWithAuthDataAndUnionId:function R(e,t,n,r){return this.loginWithAuthData(v(e,n,r),t,r)},loginWithWeapp:function D(e){var t=this;return d().then(function(n){return t.loginWithAuthData(p(n,e),h,e)})},loginWithWeappWithUnionId:function P(e,t){var n=this;return d().then(function(r){return n.loginWithAuthData(v({code:r},e,t),h,t)})},logIn:function L(){var e=this;var t=u("login",null,null,"POST",this.toJSON());return t.then(function(t){var n=e.parse(t);e._finishFetch(n);return e._handleSaveResult(true).then(function(){if(!n.smsCode)delete e.attributes["smsCode"];return e})})},save:function F(t,n,r){var s,o;if(i.isObject(t)||i.isNull(t)||i.isUndefined(t)){s=t;o=n}else{s={};s[t]=n;o=r}o=o||{};return e.Object.prototype.save.call(this,s,o).then(function(e){return e._handleSaveResult(false).then(function(){return e})})},follow:function q(t,n){if(!this.id){throw new Error("Please signin.")}var r=void 0;var s=void 0;if(t.user){r=t.user;s=t.attributes}else{r=t}var o=i.isString(r)?r:r.id;if(!o){throw new Error("Invalid target user.")}var a="users/"+this.id+"/friendship/"+o;var c=u(a,null,null,"POST",e._encode(s),n);return c},unfollow:function M(e,t){if(!this.id){throw new Error("Please signin.")}var n=void 0;if(e.user){n=e.user}else{n=e}var r=i.isString(n)?n:n.id;if(!r){throw new Error("Invalid target user.")}var s="users/"+this.id+"/friendship/"+r;var o=u(s,null,null,"DELETE",null,t);return o},followerQuery:function W(){return e.User.followerQuery(this.id)},followeeQuery:function B(){return e.User.followeeQuery(this.id)},fetch:function J(t,n){return e.Object.prototype.fetch.call(this,t,n).then(function(e){return e._handleSaveResult(false).then(function(){return e})})},updatePassword:function Q(e,t,n){var r="users/"+this.id+"/updatePassword";var i={old_password:e,new_password:t};var s=u(r,null,null,"PUT",i,n);return s},isCurrent:function V(){return this._isCurrentUser},getUsername:function K(){return this.get("username")},getMobilePhoneNumber:function z(){return this.get("mobilePhoneNumber")},setMobilePhoneNumber:function G(e,t){return this.set("mobilePhoneNumber",e,t)},setUsername:function H(e,t){return this.set("username",e,t)},setPassword:function $(e,t){return this.set("password",e,t)},getEmail:function X(){return this.get("email")},setEmail:function Y(e,t){return this.set("email",e,t)},authenticated:function Z(){console.warn("DEPRECATED:  currentUser.isAuthenticated().then() user.id === currentUser.id");return!!this._sessionToken&&!e._config.disableCurrentUser&&e.User.current()&&e.User.current().id===this.id},isAuthenticated:function ee(){var t=this;return f.resolve().then(function(){return!!t._sessionToken&&e.User._fetchUserBySessionToken(t._sessionToken).then(function(){return true},function(e){if(e.code===211){return false}throw e})})},getSessionToken:function te(){return this._sessionToken},refreshSessionToken:function ne(e){var t=this;return u("users/"+this.id+"/refreshSessionToken",null,null,"PUT",null,e).then(function(e){t._finishFetch(e);return t._handleSaveResult(true).then(function(){return t})})},getRoles:function re(t){return e.Relation.reverseQuery("_Role","users",this).find(t);
}},{_currentUser:null,_currentUserMatchesDisk:false,_CURRENT_USER_KEY:"currentUser",_authProviders:{},signUp:function ie(t,n,r,i){r=r||{};r.username=t;r.password=n;var s=e.Object._create("_User");return s.signUp(r,i)},logIn:function se(t,n){var r=e.Object._create("_User");r._finishFetch({username:t,password:n});return r.logIn()},become:function oe(e){return this._fetchUserBySessionToken(e).then(function(e){return e._handleSaveResult(true).then(function(){return e})})},_fetchUserBySessionToken:function ae(t){var n=e.Object._create("_User");return c({method:"GET",path:"/users/me",authOptions:{sessionToken:t}}).then(function(e){var t=n.parse(e);n._finishFetch(t);return n})},logInWithMobilePhoneSmsCode:function ue(t,n){var r=e.Object._create("_User");r._finishFetch({mobilePhoneNumber:t,smsCode:n});return r.logIn()},signUpOrlogInWithMobilePhone:function ce(t,n,r,i){r=r||{};r.mobilePhoneNumber=t;r.smsCode=n;var s=e.Object._create("_User");return s.signUpOrlogInWithMobilePhone(r,i)},logInWithMobilePhone:function fe(t,n){var r=e.Object._create("_User");r._finishFetch({mobilePhoneNumber:t,password:n});return r.logIn()},loginWithEmail:function le(t,n){var r=e.Object._create("_User");r._finishFetch({email:t,password:n});return r.logIn()},loginWithAuthData:function he(t,n,r){return e.User._logInWith(n,t,r)},signUpOrlogInWithAuthData:function de(){console.warn("DEPRECATED: User.signUpOrlogInWithAuthData  User#loginWithAuthData ");return this.loginWithAuthData.apply(this,arguments)},loginWithAuthDataAndUnionId:function pe(e,t,n,r){return this.loginWithAuthData(v(e,n,r),t,r)},signUpOrlogInWithAuthDataAndUnionId:function ve(){console.warn("DEPRECATED: User.signUpOrlogInWithAuthDataAndUnionId  User#loginWithAuthDataAndUnionId ");return this.loginWithAuthDataAndUnionId.apply(this,arguments)},loginWithWeapp:function _e(e){var t=this;return d().then(function(n){return t.loginWithAuthData(p(n,e),h,e)})},loginWithWeappWithUnionId:function ye(e,t){var n=this;return d().then(function(r){return n.loginWithAuthData(v({code:r},e,t),h,t)})},loginAnonymously:function me(){return this.loginWithAuthData({id:s()},"anonymous")},associateWithAuthData:function ge(e,t,n){console.warn("DEPRECATED: User.associateWithAuthData  User#associateWithAuthData ");return e._linkWith(t,n)},logOut:function be(){if(e._config.disableCurrentUser){console.warn("AV.User.current() was disabled in multi-user environment, call logOut() from user object instead https://leancloud.cn/docs/leanengine-node-sdk-upgrade-1.html");return f.resolve(null)}if(e.User._currentUser!==null){e.User._currentUser._logOutWithAll();e.User._currentUser._isCurrentUser=false}e.User._currentUserMatchesDisk=true;e.User._currentUser=null;return e.localStorage.removeItemAsync(e._getAVPath(e.User._CURRENT_USER_KEY)).then(function(){return e._refreshSubscriptionId()})},followerQuery:function we(t){if(!t||!i.isString(t)){throw new Error("Invalid user object id.")}var n=new e.FriendShipQuery("_Follower");n._friendshipTag="follower";n.equalTo("user",e.Object.createWithoutData("_User",t));return n},followeeQuery:function Oe(t){if(!t||!i.isString(t)){throw new Error("Invalid user object id.")}var n=new e.FriendShipQuery("_Followee");n._friendshipTag="followee";n.equalTo("user",e.Object.createWithoutData("_User",t));return n},requestPasswordReset:function Ae(e){var t={email:e};var n=u("requestPasswordReset",null,null,"POST",t);return n},requestEmailVerify:function Se(e){var t={email:e};var n=u("requestEmailVerify",null,null,"POST",t);return n},requestMobilePhoneVerify:function Ce(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n={mobilePhoneNumber:e};if(t.validateToken){n.validate_token=t.validateToken}var r=u("requestMobilePhoneVerify",null,null,"POST",n,t);return r},requestPasswordResetBySmsCode:function Ee(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n={mobilePhoneNumber:e};if(t.validateToken){n.validate_token=t.validateToken}var r=u("requestPasswordResetBySmsCode",null,null,"POST",n,t);return r},resetPasswordBySmsCode:function Te(e,t){var n={password:t};var r=u("resetPasswordBySmsCode",null,e,"PUT",n);return r},verifyMobilePhone:function Ne(e){var t=u("verifyMobilePhone",null,e,"POST",null);return t},requestLoginSmsCode:function je(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n={mobilePhoneNumber:e};if(t.validateToken){n.validate_token=t.validateToken}var r=u("requestLoginSmsCode",null,null,"POST",n,t);return r},currentAsync:function xe(){if(e._config.disableCurrentUser){console.warn("AV.User.currentAsync() was disabled in multi-user environment, access user from request instead https://leancloud.cn/docs/leanengine-node-sdk-upgrade-1.html");return f.resolve(null)}if(e.User._currentUser){return f.resolve(e.User._currentUser)}if(e.User._currentUserMatchesDisk){return f.resolve(e.User._currentUser)}return e.localStorage.getItemAsync(e._getAVPath(e.User._CURRENT_USER_KEY)).then(function(t){if(!t){return null}e.User._currentUserMatchesDisk=true;e.User._currentUser=e.Object._create("_User");e.User._currentUser._isCurrentUser=true;var n=JSON.parse(t);e.User._currentUser.id=n._id;delete n._id;e.User._currentUser._sessionToken=n._sessionToken;delete n._sessionToken;e.User._currentUser._finishFetch(n);e.User._currentUser._synchronizeAllAuthData();e.User._currentUser._refreshCache();e.User._currentUser._opSetQueue=[{}];return e.User._currentUser})},current:function Ue(){if(e._config.disableCurrentUser){console.warn("AV.User.current() was disabled in multi-user environment, access user from request instead https://leancloud.cn/docs/leanengine-node-sdk-upgrade-1.html");return null}if(e.User._currentUser){return e.User._currentUser}if(e.User._currentUserMatchesDisk){return e.User._currentUser}e.User._currentUserMatchesDisk=true;var t=e.localStorage.getItem(e._getAVPath(e.User._CURRENT_USER_KEY));if(!t){return null}e.User._currentUser=e.Object._create("_User");e.User._currentUser._isCurrentUser=true;var n=JSON.parse(t);e.User._currentUser.id=n._id;delete n._id;e.User._currentUser._sessionToken=n._sessionToken;delete n._sessionToken;e.User._currentUser._finishFetch(n);e.User._currentUser._synchronizeAllAuthData();e.User._currentUser._refreshCache();e.User._currentUser._opSetQueue=[{}];return e.User._currentUser},_saveCurrentUser:function ke(t){var n;if(e.User._currentUser!==t){n=e.User.logOut()}else{n=f.resolve()}return n.then(function(){t._isCurrentUser=true;e.User._currentUser=t;var n=t._toFullJSON();n._id=t.id;n._sessionToken=t._sessionToken;return e.localStorage.setItemAsync(e._getAVPath(e.User._CURRENT_USER_KEY),JSON.stringify(n)).then(function(){e.User._currentUserMatchesDisk=true;return e._refreshSubscriptionId()})})},_registerAuthenticationProvider:function Ie(t){e.User._authProviders[t.getAuthType()]=t;if(!e._config.disableCurrentUser&&e.User.current()){e.User.current()._synchronizeAuthData(t.getAuthType())}},_logInWith:function Re(t,n,r){var i=e.Object._create("_User");return i._linkWith(t,n,r)}})}},function(e,t,n){"use strict";var r=n(0);var i=n(6)("leancloud:query");var s=n(1);var o=n(4);var a=n(2),u=a._request,c=a.request;var f=n(3),l=f.ensureArray,h=f.transformFetchOptions;var d=function p(e,t){if(e===undefined){throw new Error(t)}};e.exports=function(e){e.Query=function(t){if(r.isString(t)){t=e.Object._getSubclass(t)}this.objectClass=t;this.className=t.prototype.className;this._where={};this._include=[];this._select=[];this._limit=-1;this._skip=0;this._extraOptions={}};e.Query.or=function(){var t=r.toArray(arguments);var n=null;e._arrayEach(t,function(e){if(r.isNull(n)){n=e.className}if(n!==e.className){throw new Error("All queries must be for the same class")}});var i=new e.Query(n);i._orQuery(t);return i};e.Query.and=function(){var t=r.toArray(arguments);var n=null;e._arrayEach(t,function(e){if(r.isNull(n)){n=e.className}if(n!==e.className){throw new Error("All queries must be for the same class")}});var i=new e.Query(n);i._andQuery(t);return i};e.Query.doCloudQuery=function(t,n,i){var s={cql:t};if(r.isArray(n)){s.pvalues=n}else{i=n}var o=u("cloudQuery",null,null,"GET",s,i);return o.then(function(t){var n=new e.Query(t.className);var i=r.map(t.results,function(e){var r=n._newObject(t);if(r._finishFetch){r._finishFetch(n._processResult(e),true)}return r});return{results:i,count:t.count,className:t.className}})};e.Query._extend=e._extend;r.extend(e.Query.prototype,{_processResult:function t(e){return e},get:function n(e,t){if(!e){var n=new o(o.OBJECT_NOT_FOUND,"Object not found.");throw n}var i=this._newObject();i.id=e;var s=this.toJSON();var a={};if(s.keys)a.keys=s.keys;if(s.include)a.include=s.include;if(s.includeACL)a.includeACL=s.includeACL;return u("classes",this.className,e,"GET",h(a),t).then(function(e){if(r.isEmpty(e))throw new o(o.OBJECT_NOT_FOUND,"Object not found.");i._finishFetch(i.parse(e),true);return i})},toJSON:function a(){var t={where:this._where};if(this._include.length>0){t.include=this._include.join(",")}if(this._select.length>0){t.keys=this._select.join(",")}if(this._includeACL!==undefined){t.returnACL=this._includeACL}if(this._limit>=0){t.limit=this._limit}if(this._skip>0){t.skip=this._skip}if(this._order!==undefined){t.order=this._order}e._objectEach(this._extraOptions,function(e,n){t[n]=e});return t},_newObject:function f(t){var n;if(t&&t.className){n=new e.Object(t.className)}else{n=new this.objectClass}return n},_createRequest:function p(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.toJSON();var t=arguments[1];var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"/classes/"+this.className;if(encodeURIComponent(JSON.stringify(e)).length>2e3){var r={requests:[{method:"GET",path:"/1.1"+n,params:e}]};return c({path:"/batch",method:"POST",data:r,authOptions:t}).then(function(e){var t=e[0];if(t.success){return t.success}var n=new Error(t.error.error||"Unknown batch error");n.code=t.error.code;throw n})}return c({method:"GET",path:n,query:e,authOptions:t})},_parseResponse:function v(e){var t=this;return r.map(e.results,function(n){var r=t._newObject(e);if(r._finishFetch){r._finishFetch(t._processResult(n),true)}return r})},find:function _(e){var t=this._createRequest(undefined,e);return t.then(this._parseResponse.bind(this))},scan:function y(){var e=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=t.orderedBy,o=t.batchSize;var a=arguments[1];var c=this.toJSON();i("scan %O",c);if(c.order){console.warn("The order of the query is ignored for Query#scan. Checkout the orderedBy option of Query#scan.");delete c.order}if(c.skip){console.warn("The skip option of the query is ignored for Query#scan.");delete c.skip}if(c.limit){console.warn("The limit option of the query is ignored for Query#scan.");delete c.limit}if(n)c.scan_key=n;if(o)c.limit=o;var f=s.resolve([]);var l=void 0;var h=false;return{next:function d(){f=f.then(function(t){if(h)return[];if(t.length>1)return t;if(!l&&t.length!==0){h=true;return t}return u("scan/classes",e.className,null,"GET",l?r.extend({},c,{cursor:l}):c,a).then(function(t){l=t.cursor;return e._parseResponse(t)}).then(function(e){if(!e.length)h=true;return t.concat(e)})});return f.then(function(e){return e.shift()}).then(function(e){return{value:e,done:h}})}}},destroyAll:function m(t){var n=this;return n.find(t).then(function(n){return e.Object.destroyAll(n,t)})},count:function g(e){var t=this.toJSON();t.limit=0;t.count=1;var n=this._createRequest(t,e);return n.then(function(e){return e.count})},first:function b(e){var t=this;var n=this.toJSON();n.limit=1;var i=this._createRequest(n,e);return i.then(function(e){return r.map(e.results,function(e){var n=t._newObject();if(n._finishFetch){n._finishFetch(t._processResult(e),true)}return n})[0]})},skip:function w(e){d(e,"undefined is not a valid skip value");this._skip=e;return this},limit:function O(e){d(e,"undefined is not a valid limit value");this._limit=e;return this},equalTo:function A(t,n){d(t,"undefined is not a valid key");d(n,"undefined is not a valid value");this._where[t]=e._encode(n);return this},_addCondition:function S(t,n,r){d(t,"undefined is not a valid condition key");d(n,"undefined is not a valid condition");d(r,"undefined is not a valid condition value");if(!this._where[t]){this._where[t]={}}this._where[t][n]=e._encode(r);return this},sizeEqualTo:function C(e,t){this._addCondition(e,"$size",t);return this},notEqualTo:function E(e,t){this._addCondition(e,"$ne",t);return this},lessThan:function T(e,t){this._addCondition(e,"$lt",t);return this},greaterThan:function N(e,t){this._addCondition(e,"$gt",t);return this},lessThanOrEqualTo:function j(e,t){this._addCondition(e,"$lte",t);return this},greaterThanOrEqualTo:function x(e,t){this._addCondition(e,"$gte",t);return this},containedIn:function U(e,t){this._addCondition(e,"$in",t);return this},notContainedIn:function k(e,t){this._addCondition(e,"$nin",t);return this},containsAll:function I(e,t){this._addCondition(e,"$all",t);return this},exists:function R(e){this._addCondition(e,"$exists",true);return this},doesNotExist:function D(e){this._addCondition(e,"$exists",false);return this},matches:function P(e,t,n){this._addCondition(e,"$regex",t);if(!n){n=""}if(t.ignoreCase){n+="i"}if(t.multiline){n+="m"}if(n&&n.length){this._addCondition(e,"$options",n)}return this},matchesQuery:function L(e,t){var n=t.toJSON();n.className=t.className;this._addCondition(e,"$inQuery",n);return this},doesNotMatchQuery:function F(e,t){var n=t.toJSON();n.className=t.className;this._addCondition(e,"$notInQuery",n);return this},matchesKeyInQuery:function q(e,t,n){var r=n.toJSON();r.className=n.className;this._addCondition(e,"$select",{key:t,query:r});return this},doesNotMatchKeyInQuery:function M(e,t,n){var r=n.toJSON();r.className=n.className;this._addCondition(e,"$dontSelect",{key:t,query:r});return this},_orQuery:function W(e){var t=r.map(e,function(e){return e.toJSON().where});this._where.$or=t;return this},_andQuery:function B(e){var t=r.map(e,function(e){return e.toJSON().where});this._where.$and=t;return this},_quote:function J(e){return"\\Q"+e.replace("\\E","\\E\\\\E\\Q")+"\\E"},contains:function Q(e,t){this._addCondition(e,"$regex",this._quote(t));return this},startsWith:function V(e,t){this._addCondition(e,"$regex","^"+this._quote(t));return this},endsWith:function K(e,t){this._addCondition(e,"$regex",this._quote(t)+"$");return this},ascending:function z(e){d(e,"undefined is not a valid key");this._order=e;return this},addAscending:function G(e){d(e,"undefined is not a valid key");if(this._order)this._order+=","+e;else this._order=e;return this},descending:function H(e){d(e,"undefined is not a valid key");this._order="-"+e;return this},addDescending:function $(e){d(e,"undefined is not a valid key");if(this._order)this._order+=",-"+e;else this._order="-"+e;return this},near:function X(t,n){if(!(n instanceof e.GeoPoint)){n=new e.GeoPoint(n)}this._addCondition(t,"$nearSphere",n);return this},withinRadians:function Y(e,t,n){this.near(e,t);this._addCondition(e,"$maxDistance",n);return this},withinMiles:function Z(e,t,n){return this.withinRadians(e,t,n/3958.8)},withinKilometers:function ee(e,t,n){return this.withinRadians(e,t,n/6371)},withinGeoBox:function te(t,n,r){if(!(n instanceof e.GeoPoint)){n=new e.GeoPoint(n)}if(!(r instanceof e.GeoPoint)){r=new e.GeoPoint(r)}this._addCondition(t,"$within",{$box:[n,r]});return this},include:function ne(e){var t=this;d(e,"undefined is not a valid key");r(arguments).forEach(function(e){t._include=t._include.concat(l(e))});return this},includeACL:function re(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this._includeACL=e;return this},select:function ie(e){var t=this;d(e,"undefined is not a valid key");r(arguments).forEach(function(e){t._select=t._select.concat(l(e))});return this},each:function se(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(this._order||this._skip||this._limit>=0){var i=new Error("Cannot iterate on a query with sort, skip, or limit.");return s.reject(i)}var o=new e.Query(this.objectClass);o._limit=n.batchSize||100;o._where=r.clone(this._where);o._include=r.clone(this._include);o.ascending("objectId");var a=false;return s._continueWhile(function(){return!a},function(){return o.find(n).then(function(e){var n=s.resolve();r.each(e,function(e){n=n.then(function(){return t(e)})});return n.then(function(){if(e.length>=o._limit){o.greaterThan("objectId",e[e.length-1].id)}else{a=true}})})})},subscribe:function oe(t){return e.LiveQuery.init(this,t)}});e.FriendShipQuery=e.Query._extend({_newObject:function ae(){var t=e.Object._getSubclass("_User");return new t},_processResult:function ue(e){if(e&&e[this._friendshipTag]){var t=e[this._friendshipTag];if(t.__type==="Pointer"&&t.className==="_User"){delete t.__type;delete t.className}return t}else{return null}}})}},function(e,t,n){"use strict";var r=n(0);var i=n(53);var s=n(1);var o=n(3),a=o.inherits;var u=n(2),c=u.request;var f=function l(e,t){return c({method:"POST",path:"/LiveQuery/subscribe",data:{query:e,id:t}})};e.exports=function(e){var t=function n(){if(!e._config.realtime){throw new Error("LiveQuery not supported. Please use the LiveQuery bundle. https://url.leanapp.cn/enable-live-query")}};e.LiveQuery=a(i,{constructor:function o(e,t,n,r){var s=this;i.apply(this);this.id=e;this._client=t;this._client.register(this);this._queryJSON=n;this._subscriptionId=r;this._onMessage=this._dispatch.bind(this);this._onReconnect=function(){f(s._queryJSON,s._subscriptionId).catch(function(e){return console.error("LiveQuery resubscribe error: "+e.message)})};t.on("message",this._onMessage);t.on("reconnect",this._onReconnect)},_dispatch:function u(t){var n=this;t.forEach(function(t){var i=t.op,s=t.object,o=t.query_id,a=t.updatedKeys;if(o!==n.id)return;var u=e.parseJSON(r.extend({__type:s.className==="_File"?"File":"Object"},s));if(a){n.emit(i,u,a)}else{n.emit(i,u)}})},unsubscribe:function l(){var e=this._client;e.off("message",this._onMessage);e.off("reconnect",this._onReconnect);e.deregister(this);return c({method:"POST",path:"/LiveQuery/unsubscribe",data:{id:e.id,query_id:this.id}})}},{init:function h(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=r.subscriptionId,o=i===undefined?e._getSubscriptionId():i;t();if(!(n instanceof e.Query))throw new TypeError("LiveQuery must be inited with a Query");return s.resolve(o).then(function(t){return e._config.realtime.createLiveQueryClient(t).then(function(r){var i=n.toJSON(),s=i.where,o=i.keys,a=i.returnACL;var u={where:s,keys:o,returnACL:a,className:n.className};var c=f(u,t).then(function(n){var i=n.query_id;return new e.LiveQuery(i,r,u,t)}).finally(function(){r.deregister(c)});r.register(c);return c})})},pause:function d(){t();return e._config.realtime.pause()},resume:function p(){t();return e._config.realtime.resume()}})}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function s(){}if(Object.create){s.prototype=Object.create(null);if(!(new s).__proto__)i=false}function o(e,t,n){this.fn=e;this.context=t;this.once=n||false}function a(){this._events=new s;this._eventsCount=0}a.prototype.eventNames=function u(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events){if(r.call(t,n))e.push(i?n.slice(1):n)}if(Object.getOwnPropertySymbols){return e.concat(Object.getOwnPropertySymbols(t))}return e};a.prototype.listeners=function c(e,t){var n=i?i+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var s=0,o=r.length,a=new Array(o);s<o;s++){a[s]=r[s].fn}return a};a.prototype.emit=function f(e,t,n,r,s,o){var a=i?i+e:e;if(!this._events[a])return false;var u=this._events[a],c=arguments.length,f,l;if(u.fn){if(u.once)this.removeListener(e,u.fn,undefined,true);switch(c){case 1:return u.fn.call(u.context),true;case 2:return u.fn.call(u.context,t),true;case 3:return u.fn.call(u.context,t,n),true;case 4:return u.fn.call(u.context,t,n,r),true;case 5:return u.fn.call(u.context,t,n,r,s),true;case 6:return u.fn.call(u.context,t,n,r,s,o),true}for(l=1,f=new Array(c-1);l<c;l++){f[l-1]=arguments[l]}u.fn.apply(u.context,f)}else{var h=u.length,d;for(l=0;l<h;l++){if(u[l].once)this.removeListener(e,u[l].fn,undefined,true);switch(c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,r);break;default:if(!f)for(d=1,f=new Array(c-1);d<c;d++){f[d-1]=arguments[d]}u[l].fn.apply(u[l].context,f)}}}return true};a.prototype.on=function l(e,t,n){var r=new o(t,n||this),s=i?i+e:e;if(!this._events[s])this._events[s]=r,this._eventsCount++;else if(!this._events[s].fn)this._events[s].push(r);else this._events[s]=[this._events[s],r];return this};a.prototype.once=function h(e,t,n){var r=new o(t,n||this,true),s=i?i+e:e;if(!this._events[s])this._events[s]=r,this._eventsCount++;else if(!this._events[s].fn)this._events[s].push(r);else this._events[s]=[this._events[s],r];return this};a.prototype.removeListener=function d(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t){if(--this._eventsCount===0)this._events=new s;else delete this._events[o];return this}var a=this._events[o];if(a.fn){if(a.fn===t&&(!r||a.once)&&(!n||a.context===n)){if(--this._eventsCount===0)this._events=new s;else delete this._events[o]}}else{for(var u=0,c=[],f=a.length;u<f;u++){if(a[u].fn!==t||r&&!a[u].once||n&&a[u].context!==n){c.push(a[u])}}if(c.length)this._events[o]=c.length===1?c[0]:c;else if(--this._eventsCount===0)this._events=new s;else delete this._events[o]}return this};a.prototype.removeAllListeners=function p(e){var t;if(e){t=i?i+e:e;if(this._events[t]){if(--this._eventsCount===0)this._events=new s;else delete this._events[t]}}else{this._events=new s;this._eventsCount=0}return this};a.prototype.off=a.prototype.removeListener;a.prototype.addListener=a.prototype.on;a.prototype.setMaxListeners=function v(){return this};a.prefixed=i;a.EventEmitter=a;if(true){e.exports=a}},function(e,t,n){"use strict";var r=n(0);var i=n(3),s=i.tap;e.exports=function(e){e.Captcha=function t(e,n){this._options=e;this._authOptions=n;this.url=undefined;this.captchaToken=undefined;this.validateToken=undefined};e.Captcha.prototype.refresh=function n(){var t=this;return e.Cloud._requestCaptcha(this._options,this._authOptions).then(function(e){var n=e.captchaToken,i=e.url;r.extend(t,{captchaToken:n,url:i});return i})};e.Captcha.prototype.verify=function i(t){var n=this;return e.Cloud.verifyCaptcha(t,this.captchaToken).then(s(function(e){return n.validateToken=e}))};if(true){e.Captcha.prototype.bind=function o(e,t){var n=this;var r=e.textInput,i=e.image,s=e.verifyButton;var o=t.success,a=t.error;if(typeof r==="string"){r=document.getElementById(r);if(!r)throw new Error("textInput with id "+r+" not found")}if(typeof i==="string"){i=document.getElementById(i);if(!i)throw new Error("image with id "+i+" not found")}if(typeof s==="string"){s=document.getElementById(s);if(!s)throw new Error("verifyButton with id "+s+" not found")}this.__refresh=function(){return n.refresh().then(function(e){i.src=e;if(r){r.value="";r.focus()}}).catch(function(e){return console.warn("refresh captcha fail: "+e.message)})};if(i){this.__image=i;i.src=this.url;i.addEventListener("click",this.__refresh)}this.__verify=function(){var e=r.value;n.verify(e).catch(function(e){n.__refresh();throw e}).then(o,a).catch(function(e){return console.warn("verify captcha fail: "+e.message)})};if(r&&s){this.__verifyButton=s;s.addEventListener("click",this.__verify)}};e.Captcha.prototype.unbind=function a(){if(this.__image)this.__image.removeEventListener("click",this.__refresh);if(this.__verifyButton)this.__verifyButton.removeEventListener("click",this.__verify)}}e.Captcha.request=function(t,n){var r=new e.Captcha(t,n);return r.refresh().then(function(){return r})}}},function(e,t,n){"use strict";var r=n(0);var i=n(2),s=i._request,o=i.request;var a=n(1);e.exports=function(e){e.Cloud=e.Cloud||{};r.extend(e.Cloud,{run:function t(n,r,i){return o({service:"engine",method:"POST",path:"/functions/"+n,data:e._encode(r,null,true),authOptions:i}).then(function(t){return e._decode(t).result})},rpc:function n(t,i,s){if(r.isArray(i)){return a.reject(new Error("Can't pass Array as the param of rpc function in JavaScript SDK."))}return o({service:"engine",method:"POST",path:"/call/"+t,data:e._encodeObjectOrArray(i),authOptions:s}).then(function(t){return e._decode(t).result})},getServerDate:function i(){return s("date",null,null,"GET").then(function(t){return e._decode(t)})},requestSmsCode:function u(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(r.isString(e)){e={mobilePhoneNumber:e}}if(!e.mobilePhoneNumber){throw new Error("Missing mobilePhoneNumber.")}if(t.validateToken){e=r.extend({},e,{validate_token:t.validateToken})}return s("requestSmsCode",null,null,"POST",e,t)},verifySmsCode:function c(e,t){if(!e)throw new Error("Missing sms code.");var n={};if(r.isString(t)){n["mobilePhoneNumber"]=t}return s("verifySmsCode",e,null,"POST",n)},_requestCaptcha:function f(e,t){return s("requestCaptcha",null,null,"GET",e,t).then(function(e){var t=e.captcha_url,n=e.captcha_token;return{captchaToken:n,url:t}})},requestCaptcha:e.Captcha.request,verifyCaptcha:function l(e,t){return s("verifyCaptcha",null,null,"POST",{captcha_code:e,captcha_token:t}).then(function(e){var t=e.validate_token;return t})}})}},function(e,t,n){"use strict";var r=n(2).request;e.exports=function(e){e.Installation=e.Object.extend("_Installation");e.Push=e.Push||{};e.Push.send=function(e,t){if(e.where){e.where=e.where.toJSON().where}if(e.where&&e.cql){throw new Error("Both where and cql can't be set")}if(e.push_time){e.push_time=e.push_time.toJSON()}if(e.expiration_time){e.expiration_time=e.expiration_time.toJSON()}if(e.expiration_time&&e.expiration_time_interval){throw new Error("Both expiration_time and expiration_time_interval can't be set")}return r({service:"push",method:"POST",path:"/push",data:e,authOptions:t})}}},function(e,t,n){"use strict";var r=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=n(0);var s=n(1);var o=n(2)._request;var a=n(3),u=a.getSessionToken;e.exports=function(e){var t=function a(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=u(t);if(n){return e.User._fetchUserBySessionToken(u(t))}return e.User.currentAsync()};var n=function c(n){return t(n).then(function(t){return e.Object.createWithoutData("_User",t.id)._toPointer()})};e.Status=function(e,t){this.data={};this.inboxType="default";this.query=null;if(e&&(typeof e==="undefined"?"undefined":r(e))==="object"){this.data=e}else{if(e){this.data.image=e}if(t){this.data.message=t}}return this};i.extend(e.Status.prototype,{get:function f(e){return this.data[e]},set:function l(e,t){this.data[e]=t;return this},destroy:function h(e){if(!this.id)return s.reject(new Error("The status id is not exists."));var t=o("statuses",null,this.id,"DELETE",e);return t},toObject:function d(){if(!this.id)return null;return e.Object.createWithoutData("_Status",this.id)},_getDataJSON:function p(){var t=i.clone(this.data);return e._encode(t)},send:function v(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!u(r)&&!e.User.current()){throw new Error("Please signin an user.")}if(!this.query){return e.Status.sendStatusToFollowers(this,r)}return n(r).then(function(e){var n=t.query.toJSON();n.className=t.query.className;var i={};i.query=n;t.data=t.data||{};t.data.source=t.data.source||e;i.data=t._getDataJSON();i.inboxType=t.inboxType||"default";return o("statuses",null,null,"POST",i,r)}).then(function(n){t.id=n.objectId;t.createdAt=e._parseDate(n.createdAt);return t})},_finishFetch:function _(t){this.id=t.objectId;this.createdAt=e._parseDate(t.createdAt);this.updatedAt=e._parseDate(t.updatedAt);this.messageId=t.messageId;delete t.messageId;delete t.objectId;delete t.createdAt;delete t.updatedAt;this.data=e._decode(t)}});e.Status.sendStatusToFollowers=function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!u(r)&&!e.User.current()){throw new Error("Please signin an user.")}return n(r).then(function(n){var i={};i.className="_Follower";i.keys="follower";i.where={user:n};var s={};s.query=i;t.data=t.data||{};t.data.source=t.data.source||n;s.data=t._getDataJSON();s.inboxType=t.inboxType||"default";var a=o("statuses",null,null,"POST",s,r);return a.then(function(n){t.id=n.objectId;t.createdAt=e._parseDate(n.createdAt);return t})})};e.Status.sendPrivateStatus=function(t,r){var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!u(s)&&!e.User.current()){throw new Error("Please signin an user.")}if(!r){throw new Error("Invalid target user.")}var a=i.isString(r)?r:r.id;if(!a){throw new Error("Invalid target user.")}return n(s).then(function(n){var r={};r.className="_User";r.where={objectId:a};var i={};i.query=r;t.data=t.data||{};t.data.source=t.data.source||n;i.data=t._getDataJSON();i.inboxType="private";t.inboxType="private";var u=o("statuses",null,null,"POST",i,s);return u.then(function(n){t.id=n.objectId;t.createdAt=e._parseDate(n.createdAt);return t})})};e.Status.countUnreadStatuses=function(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"default";var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!i.isString(r))a=r;if(!u(a)&&n==null&&!e.User.current()){throw new Error("Please signin an user or pass the owner objectId.")}return s.resolve(n||t(a)).then(function(t){var n={};n.inboxType=e._encode(r);n.owner=e._encode(t);return o("subscribe/statuses/count",null,null,"GET",n,a)})};e.Status.resetUnreadCount=function(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"default";var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!i.isString(r))a=r;if(!u(a)&&n==null&&!e.User.current()){throw new Error("Please signin an user or pass the owner objectId.")}return s.resolve(n||t(a)).then(function(t){var n={};n.inboxType=e._encode(r);n.owner=e._encode(t);return o("subscribe/statuses/resetUnreadCount",null,null,"POST",n,a)})};e.Status.statusQuery=function(t){var n=new e.Query("_Status");if(t){n.equalTo("source",t)}return n};e.InboxQuery=e.Query._extend({_objectClass:e.Status,_sinceId:0,_maxId:0,_inboxType:"default",_owner:null,_newObject:function y(){return new e.Status},_createRequest:function m(t,n){return e.InboxQuery.__super__._createRequest.call(this,t,n,"/subscribe/statuses")},sinceId:function g(e){this._sinceId=e;return this},maxId:function b(e){this._maxId=e;return this},owner:function w(e){this._owner=e;return this},inboxType:function O(e){this._inboxType=e;return this},toJSON:function A(){var t=e.InboxQuery.__super__.toJSON.call(this);t.owner=e._encode(this._owner);t.inboxType=e._encode(this._inboxType);t.sinceId=e._encode(this._sinceId);t.maxId=e._encode(this._maxId);return t}});e.Status.inboxQuery=function(t,n){var r=new e.InboxQuery(e.Status);if(t){r._owner=t}if(n){r._inboxType=n}return r}}},function(e,t,n){"use strict";var r=n(0);var i=n(2)._request;e.exports=function(e){e.SearchSortBuilder=function(){this._sortFields=[]};r.extend(e.SearchSortBuilder.prototype,{_addField:function t(e,n,r,i){var s={};s[e]={order:n||"asc",mode:r||"avg",missing:"_"+(i||"last")};this._sortFields.push(s);return this},ascending:function n(e,t,r){return this._addField(e,"asc",t,r)},descending:function s(e,t,n){return this._addField(e,"desc",t,n)},whereNear:function o(e,t,n){n=n||{};var r={};var i={lat:t.latitude,lon:t.longitude};var s={order:n.order||"asc",mode:n.mode||"avg",unit:n.unit||"km"};s[e]=i;r["_geo_distance"]=s;this._sortFields.push(r);return this},build:function a(){return JSON.stringify(e._encode(this._sortFields))}});e.SearchQuery=e.Query._extend({_sid:null,_hits:0,_queryString:null,_highlights:null,_sortBuilder:null,
_createRequest:function u(e,t){return i("search/select",null,null,"GET",e||this.toJSON(),t)},sid:function c(e){this._sid=e;return this},queryString:function f(e){this._queryString=e;return this},highlights:function l(e){var t;if(e&&r.isString(e)){t=arguments}else{t=e}this._highlights=t;return this},sortBy:function h(e){this._sortBuilder=e;return this},hits:function d(){if(!this._hits){this._hits=0}return this._hits},_processResult:function p(e){delete e["className"];delete e["_app_url"];delete e["_deeplink"];return e},hasMore:function v(){return!this._hitEnd},reset:function _(){this._hitEnd=false;this._sid=null;this._hits=0},find:function y(){var e=this;var t=this._createRequest();return t.then(function(t){if(t.sid){e._oldSid=e._sid;e._sid=t.sid}else{e._sid=null;e._hitEnd=true}e._hits=t.hits||0;return r.map(t.results,function(n){if(n.className){t.className=n.className}var r=e._newObject(t);r.appURL=n["_app_url"];r._finishFetch(e._processResult(n),true);return r})})},toJSON:function m(){var t=e.SearchQuery.__super__.toJSON.call(this);delete t.where;if(this.className){t.clazz=this.className}if(this._sid){t.sid=this._sid}if(!this._queryString){throw new Error("Please set query string.")}else{t.q=this._queryString}if(this._highlights){t.highlights=this._highlights.join(",")}if(this._sortBuilder&&t.order){throw new Error("sort and order can not be set at same time.")}if(this._sortBuilder){t.sort=this._sortBuilder.build()}return t}})}},function(e,t,n){"use strict";var r=n(0);var i=n(4);var s=n(2),o=s.request;var a=n(1);e.exports=function(e){e.Insight=e.Insight||{};r.extend(e.Insight,{startJob:function t(n,r){if(!n||!n.sql){throw new Error("Please provide the sql to run the job.")}var i={jobConfig:n,appId:e.applicationId};return o({path:"/bigquery/jobs",method:"POST",data:e._encode(i,null,true),authOptions:r,signKey:false}).then(function(t){return e._decode(t).id})},on:function n(e,t){}});e.Insight.JobQuery=function(e,t){if(!e){throw new Error("Please provide the job id.")}this.id=e;this.className=t;this._skip=0;this._limit=100};r.extend(e.Insight.JobQuery.prototype,{skip:function s(e){this._skip=e;return this},limit:function u(e){this._limit=e;return this},find:function c(e){var t={skip:this._skip,limit:this._limit};return o({path:"/bigquery/jobs/"+this.id,method:"GET",query:t,authOptions:e,signKey:false}).then(function(e){if(e.error){return a.reject(new i(e.code,e.error))}return a.resolve(e)})}})}},function(e,t,n){"use strict";var r=n(0);var i=n(2),s=i._request;var o=n(5);var a=function u(e){if(typeof e==="string"){return e}if(typeof e.getPayload==="function"){return JSON.stringify(e.getPayload())}return JSON.stringify(e)};e.exports=o.Object.extend("_Conversation",{constructor:function c(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};o.Object.prototype.constructor.call(this,null,null);this.set("name",e);if(t.isSystem!==undefined){this.set("sys",t.isSystem?true:false)}if(t.isTransient!==undefined){this.set("tr",t.isTransient?true:false)}},getCreator:function f(){return this.get("c")},getLastMessageAt:function l(){return this.get("lm")},getMembers:function h(){return this.get("m")},addMember:function d(e){return this.add("m",e)},getMutedMembers:function p(){return this.get("mu")},getName:function v(){return this.get("name")},isTransient:function _(){return this.get("tr")},isSystem:function y(){return this.get("sys")},send:function m(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var i={from_peer:e,conv_id:this.id,"transient":false,message:a(t)};if(n.toClients!==undefined){i.to_peers=n.toClients}if(n.transient!==undefined){i.transient=n.transient?true:false}if(n.pushData!==undefined){i.push_data=n.pushData}return s("rtm","messages",null,"POST",i,r)},broadcast:function g(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var o={from_peer:e,conv_id:this.id,message:a(t)};if(n.pushData!==undefined){o.push=n.pushData}if(n.validTill!==undefined){var u=n.validTill;if(r.isDate(u)){u=u.getTime()}n.valid_till=u}return s("rtm","broadcast",null,"POST",o,i)}})},function(e,t,n){"use strict";var r=n(0);var i=n(1);var s=n(2),o=s.request;var a=n(3),u=a.ensureArray,c=a.parseDate;var f=n(5);f.LeaderboardVersionChangeInterval={NEVER:"never",DAY:"day",WEEK:"week",MONTH:"month"};f.LeaderboardOrder={ASCENDING:"ascending",DESCENDING:"descending"};f.LeaderboardUpdateStrategy={BETTER:"better",LAST:"last",SUM:"sum"};function l(e){var t=e.name,n=e.value,r=e.version;this.name=t;this.value=n;this.version=r}var h=function p(e){var t=f._decode(e),n=t.statisticName,r=t.statisticValue,i=t.version;return new l({name:n,value:r,version:i})};f.Leaderboard=function v(e){this.statisticName=e;this.order=undefined;this.updateStrategy=undefined;this.versionChangeInterval=undefined;this.version=undefined;this.nextResetAt=undefined;this.createdAt=undefined};var d=f.Leaderboard;f.Leaderboard.createWithoutData=function(e){return new d(e)};f.Leaderboard.createLeaderboard=function(e,t){var n=e.statisticName,r=e.order,i=e.versionChangeInterval,s=e.updateStrategy;return o({method:"POST",path:"/leaderboard/leaderboards",data:{statisticName:n,order:r,versionChangeInterval:i,updateStrategy:s},authOptions:t}).then(function(e){var t=new d(n);return t._finishFetch(e)})};f.Leaderboard.getLeaderboard=function(e,t){return d.createWithoutData(e).fetch(t)};f.Leaderboard.getStatistics=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},n=t.statisticNames;var r=arguments[2];return i.resolve().then(function(){if(!(e&&e.id))throw new Error("user must be an AV.User");return o({method:"GET",path:"/leaderboard/users/"+e.id+"/statistics",query:{statistics:n?u(n).join(","):undefined},authOptions:r}).then(function(e){var t=e.results;return t.map(h)})})};f.Leaderboard.updateStatistics=function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return i.resolve().then(function(){if(!(e&&e.id))throw new Error("user must be an AV.User");var i=r.map(t,function(e,t){return{statisticName:t,statisticValue:e}});var s=n.overwrite;return o({method:"POST",path:"/leaderboard/users/"+e.id+"/statistics",query:{overwrite:s?1:undefined},data:i,authOptions:n}).then(function(e){var t=e.results;return t.map(h)})})};f.Leaderboard.deleteStatistics=function(e,t,n){return i.resolve().then(function(){if(!(e&&e.id))throw new Error("user must be an AV.User");return o({method:"DELETE",path:"/leaderboard/users/"+e.id+"/statistics",query:{statistics:u(t).join(",")},authOptions:n}).then(function(){return undefined})})};r.extend(d.prototype,{_finishFetch:function _(e){var t=this;r.forEach(e,function(e,n){if(n==="updatedAt"||n==="objectId")return;if(n==="expiredAt"){n="nextResetAt"}if(n==="createdAt"){e=c(e)}if(e&&e.__type==="Date"){e=c(e.iso)}t[n]=e});return this},fetch:function y(e){var t=this;return o({method:"GET",path:"/leaderboard/leaderboards/"+this.statisticName,authOptions:e}).then(function(e){return t._finishFetch(e)})},_getResults:function m(e,t,n){var r=e.skip,i=e.limit,s=e.selectUserKeys,a=e.includeStatistics,c=e.version;return o({method:"GET",path:"/leaderboard/leaderboards/"+this.statisticName+"/ranks"+(n?"/"+n:""),query:{skip:r,limit:i,includeUser:s?u(s).join(","):undefined,includeStatistics:a?u(a).join(","):undefined,version:c},authOptions:t}).then(function(e){var t=e.results;return t.map(function(e){var t=f._decode(e),n=t.user,r=t.statisticValue,i=t.rank,s=t.statistics,o=s===undefined?[]:s;return{user:n,value:r,rank:i,includedStatistics:o.map(h)}})})},getResults:function g(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=e.skip,n=e.limit,r=e.selectUserKeys,i=e.includeStatistics,s=e.version;var o=arguments[1];return this._getResults({skip:t,limit:n,selectUserKeys:r,includeStatistics:i,version:s},o)},getResultsAroundUser:function b(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=arguments[2];if(e&&typeof e.id!=="string"){return this.getResultsAroundUser(undefined,e,t)}var r=t.limit,i=t.selectUserKeys,s=t.includeStatistics,o=t.version;return this._getResults({limit:r,selectUserKeys:i,includeStatistics:s,version:o},n,e?e.id:"self")},_update:function w(e,t){var n=this;return o({method:"PUT",path:"/leaderboard/leaderboards/"+this.statisticName,data:e,authOptions:t}).then(function(e){return n._finishFetch(e)})},updateVersionChangeInterval:function O(e,t){return this._update({versionChangeInterval:e},t)},updateUpdateStrategy:function A(e,t){return this._update({updateStrategy:e},t)},reset:function S(e){var t=this;return o({method:"PUT",path:"/leaderboard/leaderboards/"+this.statisticName+"/incrementVersion",authOptions:e}).then(function(e){return t._finishFetch(e)})},destroy:function C(e){return f.request({method:"DELETE",path:"/leaderboard/leaderboards/"+this.statisticName,authOptions:e}).then(function(){return undefined})},getArchives:function E(){var e=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=t.skip,r=t.limit;var i=arguments[1];return o({method:"GET",path:"/leaderboard/leaderboards/"+this.statisticName+"/archives",query:{skip:n,limit:r},authOptions:i}).then(function(t){var n=t.results;return n.map(function(t){var n=t.version,r=t.status,i=t.url,s=t.activatedAt,o=t.deactivatedAt;return{statisticName:e.statisticName,version:n,status:r,url:i,activatedAt:c(s.iso),deactivatedAt:c(o.iso)}})})}})}])});
//rebuild by neat 